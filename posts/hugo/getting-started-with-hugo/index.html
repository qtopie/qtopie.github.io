<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><title>使用Hugo生成静态站点 | 1001問</title><link rel=stylesheet href=/css/main.min.194caa9c1bc917dfa8a85f5f1f9061c52cd72509dc9f189142b69308127558b3.css integrity="sha256-GUyqnBvJF9+oqF9fH5BhxSzXJQncnxiRQraTCBJ1WLM=" crossorigin=anonymous><link rel=stylesheet href=/css/page.min.90a490d604fcd054d4b5219c88265352a75714a866b26e428b192affa9f31af5.css integrity="sha256-kKSQ1gT80FTUtSGciCZTUqdXFKhmsm5Cixkq/6nzGvU=" crossorigin=anonymous><link rel=stylesheet href=/css/syntax.min.e114b8cc38f57d520f373580c935a518bc6afd6dec4f1d682365cdbcf5c8218a.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css crossorigin=anonymous referrerpolicy=no-referrer><script src=/js/toc.min.87636f25caf644980403a5c1ce8b0812cfd10d1e53c08f181547966799ceccdb.js integrity="sha256-h2NvJcr2RJgEA6XBzosIEs/RDR5TwI8YFUeWZ5nOzNs=" crossorigin=anonymous type=module defer></script><script src=/js/copy-code.min.3bea0de4cfe8670f94a5d75c177f07b58fc90178efdea7f2a21449798d75b2c9.js integrity="sha256-O+oN5M/oZw+UpddcF38HtY/JAXjv3qfyohRJeY11ssk=" crossorigin=anonymous defer></script><script defer src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script defer src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js crossorigin=anonymous referrerpolicy=no-referrer onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})'></script><script src=/js/katex-block.min.2cf531bbcc318aadf5661baa2d0987ab5cb4daef473e108b1da714a37cff0b25.js integrity="sha256-LPUxu8wxiq31ZhuqLQmHq1y02u9HPhCLHacUo3z/CyU=" crossorigin=anonymous defer></script></head><body><header><nav><a href=/><h1>1001問</h1></a><div id=react-search class=search-root aria-label="Site Search"></div></nav></header><main><div class=sidebar><section class=toc><nav id=TableOfContents><ul><li><a href=#静态站点>静态站点</a><ul><li><a href=#生成工具>生成工具</a></li><li><a href=#博客主题>博客主题</a></li></ul></li><li><a href=#安装和创建站点>安装和创建站点</a><ul><li><a href=#目标>目标</a></li><li><a href=#hugo安装>Hugo安装</a></li><li><a href=#本地生成站点>本地生成站点</a></li></ul></li><li><a href=#将应用发布到firebase>将应用发布到firebase</a><ul><li><a href=#firebase工具安装>firebase工具安装</a></li><li><a href=#发布>发布</a></li><li><a href=#使用github-ci自动发布>使用github ci自动发布</a></li><li><a href=#使用azure-pipelines发布静态站点到github-pages>使用Azure Pipelines发布静态站点到GitHub Pages</a></li></ul></li><li><a href=#参考>参考</a></li></ul></nav></section></div><article id=content><div class=metadata><h1>使用Hugo生成静态站点</h1><time datetime=2016-05-02T00:06:17+08:00>May 2, 2016</time><div class=taxonomy><span id=post-categories><ul><li><strong>Categories</strong>:&nbsp;</li><li class=category-item><a href=https://qtopie.github.io/categories/tool>tool</a></li></ul></span><span id=post-tags><ul><li><strong>Tags</strong>:&nbsp;</li><li class=tag-item><a href=https://qtopie.github.io/tags/hugo><em>hugo</em></a></li></ul></span></div></div><p>本文主要分享如何使用Hugo生成静态站点，并部署到firebase (Hosting服务）上。</p><p>updated: 2021/9/29</p><h2 id=静态站点>静态站点</h2><p>静态站点，相比于动态站点（一般指需要请求后端动态生成网站内容）来说，网站内容已提前渲染好，对搜索引擎更加友好。而且网站内容一般可以直接生成静态的html/css页面, 减少浏览器js渲染，网络传输时也可以充分利用缓存, 这样网页加载也比较快， 使用户体验更好。</p><p>更进一步地，Google和Twitter合作开发了AMP(Accelerated Mobile Pages)技术, 通过限定HTML标签和CSS，以及CDN缓存，提升移动设备(相比于PC端：弱网、低性能）对网站的访问速度。</p><p>本站点就是采用了AMP技术构建, 使用静态站点生成工具根据模板，将markdown文件渲染输出为静态AMP页面。</p><h3 id=生成工具>生成工具</h3><p>静态站点生成工具有很多，我主要用过的有以下两个。（目前又换回了Hugo)</p><ul><li><a href=https://gohugo.io/>Hugo</a></li><li><a href=https://scully.io/>Scully</a></li></ul><blockquote><p>PS, Hugo刚发布不久我就开始使用了，当时对这个新工具很喜欢，它是一个单独的二进制文件, 且渲染很快，模板丰富。但后面想定制一些功能（那时Hugo的文档比较少，仅官网使用文档， 且功能也没现在这么丰富), 但go的语法还是比较复杂的，也没太多时间看源码。因此当Scully出现的时候，我就立即使用了它（因为本人还是一个Angular粉），相比于Hugo，Scully几乎等同于你可以通过编写Angular应用定制你的网站, 因此十分灵活（主要的缺点是主题和应用代码分开进程渲染，调试略麻烦）。但后面发现，我本身写博客主题的时间可能比我写博客还花的多：》，也是该冷静下想想我的初衷是什么了。其实就是为了记录一些知识并分享，因此AMP才是我的需要。所以我决定我的博客主题的核心是简洁并对阅读友好, 而不是增添许多看其来很有趣的功能。</p></blockquote><h3 id=博客主题>博客主题</h3><p>这里列出我用过的博客主题</p><ul><li><p>Hugo</p><ul><li><a href>Robust</a></li><li><a href>amp-blog-theme</a></li></ul></li><li><p>Scully</p><ul><li><a href>mdblog-theme</a></li></ul></li></ul><p><em>以下内容主要介绍Hugo使用</em></p><h2 id=安装和创建站点>安装和创建站点</h2><h3 id=目标>目标</h3><ul><li>在本地电脑安装hugo, 在github上创建私有仓库<code>posts</code>，存放markdown源码及图片等文件；</li><li>在github创建私有仓库<code>qtopie.web.app</code>（作为集成仓库）, 对应于站点名称，存放站点配置文件。</li><li>创建firebase hosting项目，将站点<code>qtopie.web.app</code>发布到firebase.</li></ul><p><em>仓库创建过程省略</em></p><h3 id=hugo安装>Hugo安装</h3><p>以在Ubuntu 20.04上为例</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo snap install hugo
</span></span></code></pre></div><h3 id=本地生成站点>本地生成站点</h3><p>初始化git各模块</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>// git clone ... <span class=p>;</span> <span class=nb>cd</span> &lt;repo&gt;
</span></span><span class=line><span class=cl>hugo new site .
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>git submodule add https://github.com/qtopierw/amp-blog-theme.git themes/amp-blog-theme
</span></span><span class=line><span class=cl>git submodule add git@github.com:&lt;username&gt;/posts.git content/posts
</span></span></code></pre></div><p>创建<code>.gitignore</code>文件, 并加入<code>public</code>目录</p><p>现在可以使用<code>hugo</code>命令生成站点了（将输出到<code>public</code>目录），或使用<code>hugo server</code>命令进入开发模式</p><h2 id=将应用发布到firebase>将应用发布到firebase</h2><h3 id=firebase工具安装>firebase工具安装</h3><p>firbase是一个nodejs应用工具包，需要使用<code>npm</code>或者<code>yarn</code>安装</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo yarn global add firebase-tools
</span></span></code></pre></div><h3 id=发布>发布</h3><ul><li>登录firebase账号</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>firebase login
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 如果需要使用代理</span>
</span></span><span class=line><span class=cl>proxychains4 firebase login
</span></span></code></pre></div><ul><li>初始化项目</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>firebase init
</span></span></code></pre></div><p>选择发布到firebase hosting和生成github CI (选择不覆盖public目录下的静态文件）</p><p>可以将github ci修改如下</p><p><strong>.github/workflows/firebase-hosting-merge.yml</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># This file was auto-generated by the Firebase CLI</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c># https://github.com/firebase/firebase-tools</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Deploy to Firebase Hosting on merge</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>&#39;on&#39;</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>push</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># 新增部分</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>repository_dispatch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>types</span><span class=p>:</span><span class=w> </span><span class=l>sub_commit</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>build_and_deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-20.04</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># 修改部分 - start</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>submodules</span><span class=p>:</span><span class=w> </span><span class=l>recursive</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>token</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.PRIVATE_REPO_ACCESS_TOKEN }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>PullLatestPosts</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>git submodule update --recursive --remote</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>generate sites</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>sudo snap install hugo &amp;&amp; hugo --minify</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># 修改部分 - end</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>FirebaseExtended/action-hosting-deploy@v0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>repoToken</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;${{ secrets.GITHUB_TOKEN }}&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>firebaseServiceAccount</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;${{ secrets.FIREBASE_SERVICE_ACCOUNT_QTOPIE }}&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>channelId</span><span class=p>:</span><span class=w> </span><span class=l>live</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>projectId</span><span class=p>:</span><span class=w> </span><span class=l>qtopie</span><span class=w>
</span></span></span></code></pre></div><p>使用<code>firebase deploy</code>命令可以直接发布<code>public</code>目录下的文件到github</p><h3 id=使用github-ci自动发布>使用github ci自动发布</h3><p>当博客主题创建好后，实际上我们很少需要修改它，更多的时候我们是在改markdown文件，即提交代码到<code>posts</code>仓库。</p><p>因此我们可以通过在<code>posts</code>仓库创建<code>github actions</code>，通过上面设置的<code>sub_commit</code>触发器，让集成仓库拉取各分支最新代码，构建站点和发布.</p><p><code>posts</code>仓库 github actions配置如下</p><p><strong>.github/workflows/trigger-events.yml</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Dispatch Event</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>on</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>push]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>build</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-20.04</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>dispatch event to another repository</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>GITHUB_TOKEN</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.PRIVATE_REPO_ACCESS_TOKEN }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>EVENT</span><span class=p>:</span><span class=w> </span><span class=l>sub_commit</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>ORG</span><span class=p>:</span><span class=w> </span><span class=l>qtopierw</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>REPO</span><span class=p>:</span><span class=w> </span><span class=l>qtopie.web.app</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>        curl --fail -d &#34;{\&#34;event_type\&#34;: \&#34;${EVENT}\&#34;}&#34; -H &#34;Content-Type: application/json&#34; -H &#34;Authorization: token ${GITHUB_TOKEN}&#34; -H &#34;Accept: application/vnd.github.everest-preview+json&#34; &#34;https://api.github.com/repos/${ORG}/${REPO}/dispatches&#34;</span><span class=w>
</span></span></span></code></pre></div><p>这里注意到，我们在两个仓库都使用了一个CI私有环境变量<code>PRIVATE_REPO_ACCESS_TOKEN</code>，这个token我们可以在<a href=https://github.com/settings/tokens>个人github settings页面生成</a>, <code>scope</code>选择<code>repo</code>(全勾)，然后将token复制后，在两个私有项目下分别创建一个Secret即可（名称<code>PRIVATE_REPO_ACCESS_TOKEN</code>, 值为复制的token)</p><blockquote><p>比如我的<code>posts</code>仓库设置secrets的链接为https://github.com/qtopierw/posts/settings/secrets/actions</p></blockquote><p>设置完毕后，提交<code>posts</code>仓库的更改就可以实现自动发布到站点了。</p><h3 id=使用azure-pipelines发布静态站点到github-pages>使用Azure Pipelines发布静态站点到GitHub Pages</h3><p><em>这是旧的内容，可忽略</em></p><p><a href=https://pages.github.com/>GitHub Pages</a> is really a great place to host static site, and to make it easier to publish your blog, you may want to you some CI pipeline to autmoate this.</p><p>You may want to keep your blog source files private while release static files in github page. Fortunately, github has already provided free private git repos. But to enable github page on private repo you need to <code>Upgrade to GitHub Pro or make this repository public to enable Pages.</code>, so for totally free hosting you have to create one public repo to host released static blog files.
And I just found <a href=https://azure.microsoft.com/en-us/services/devops/pipelines/>Azure Pipelines</a> provides 1 free CI job which can be used to automate publishing blogs, and here&rsquo;s an good tutorial for <a href=https://cloudblogs.microsoft.com/opensource/2019/04/05/publishing-github-pages-from-azure-pipelines/><code>Publishing GitHub Pages from Azure Pipelines</code></a>.</p><p>So now it becomes, what we&rsquo;re going to need:</p><ul><li>Register to use Azure Pipelines</li><li>One Github private repo to store blog source files and one public repo to host released github pages.</li></ul><p>On you private repo, add azure pipeline configuration:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># Blog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c># Build hugo blog in azure pipeline for private repo and publish it on public repo to use github pages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=c># https://cloudblogs.microsoft.com/opensource/2019/04/05/publishing-github-pages-from-azure-pipelines/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>trigger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl>- <span class=l>master</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>pool</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>vmImage</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;ubuntu-latest&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl>- <span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>    if [ -f public ]; then rm -r public; fi
</span></span></span><span class=line><span class=cl><span class=sd>    git clone https://your-repo.github.io.git public
</span></span></span><span class=line><span class=cl><span class=sd>    git submodule init &amp;&amp; git submodule update</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>displayName</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;Clone Github Pages&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl>- <span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>    sudo snap install hugo
</span></span></span><span class=line><span class=cl><span class=sd>    hugo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>displayName</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;Generating docs&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl>- <span class=nt>task</span><span class=p>:</span><span class=w> </span><span class=l>DownloadSecureFile@1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>inputs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>secureFile</span><span class=p>:</span><span class=w> </span><span class=l>deploy_key</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>displayName</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;Get the deploy key&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl>- <span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>    mkdir ~/.ssh &amp;&amp; mv $DOWNLOADSECUREFILE_SECUREFILEPATH ~/.ssh/id_rsa
</span></span></span><span class=line><span class=cl><span class=sd>    chmod 700 ~/.ssh &amp;&amp; chmod 600 ~/.ssh/id_rsa
</span></span></span><span class=line><span class=cl><span class=sd>    ssh-keyscan -t rsa github.com &gt;&gt; ~/.ssh/known_hosts</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>displayName</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;Setup git deploy key&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl>- <span class=nt>script</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>    cd public
</span></span></span><span class=line><span class=cl><span class=sd>    git config --local user.name &#34;your-name&#34;
</span></span></span><span class=line><span class=cl><span class=sd>    git config --local user.email &#34;you-email@users.noreply.github.com&#34;
</span></span></span><span class=line><span class=cl><span class=sd>    git add .
</span></span></span><span class=line><span class=cl><span class=sd>    git commit -m &#34;Publishing GitHub Pages  ***NO_CI***&#34;
</span></span></span><span class=line><span class=cl><span class=sd>    git remote set-url --push origin git@your-repo.github.io.git
</span></span></span><span class=line><span class=cl><span class=sd>    git push origin HEAD:master</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>displayName</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;Publish GitHub Pages&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>condition</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>    and(not(eq(variables[&#39;Build.Reason&#39;], &#39;PullRequest&#39;)),
</span></span></span><span class=line><span class=cl><span class=sd>        eq(variables[&#39;Build.SourceBranch&#39;], &#39;refs/heads/master&#39;))</span><span class=w>
</span></span></span></code></pre></div><p>Note that in my experience, every time use <code>hugo</code> to generate sites, it will make file changes on <code>public/en/sitemap.xml</code>,
so no need to worry about <code>git commit</code> would fail.</p><p>On your public repo, add deployment key(recommend to use separate ssh key file on this repo for security reason, and write permission is needed). Then add the private ssh key named <code>deploy_key</code> in <code>azure pipelines -> Library -> secure file</code>.</p><h2 id=参考>参考</h2><ul><li><a href=https://themes.gohugo.io/>https://themes.gohugo.io/</a></li><li><a href=https://github.com/dim0627/hugo_theme_robust>https://github.com/dim0627/hugo_theme_robust</a></li><li><a href=https://gohugo.io/hosting-and-deployment/hosting-on-firebase/>https://gohugo.io/hosting-and-deployment/hosting-on-firebase/</a></li></ul></article><div id=react-app-components data-post-id=1e54214fd7aa55a0d6e3b89bd5902047></div><button class=mobile-toc-trigger aria-controls=mobile-toc aria-expanded=false title=Index>☰</button><div class=mobile-toc-overlay hidden></div><div id=mobile-toc class=mobile-toc-drawer aria-hidden=true role=dialog aria-label=Index><div class=mobile-toc-header><button class=mobile-toc-close aria-label=close>×</button></div><nav class=mobile-toc-body><div class=mobile-toc-list></div></nav><div class=mobile-safe-area-spacer></div></div><script type=module src=/react/page.bundle.js></script></main><footer><div class=copyright><small>Made with <span style=color:#e25555>&#9829;</span> in Guangzhou by
©<a href=https://github.com/qtopie>qtopie</a> 2026
</small><small>Posts licensed under <a href=https://creativecommons.org/licenses/by/4.0/legalcode>CC BY 4.0</small></div><div><script type=module src=/react/base.bundle.js></script></div></footer></body></html>