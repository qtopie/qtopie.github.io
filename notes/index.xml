<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Notes on Blog | qtopie</title><link>https://qtopie.github.io/notes/</link><description>Recent content in Notes on Blog | qtopie</description><generator>Hugo</generator><language>en-us</language><copyright>Posts licensed under &lt;a href="https://creativecommons.org/licenses/by/4.0/legalcode"&gt;CC BY 4.0</copyright><lastBuildDate>Sun, 29 Jun 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://qtopie.github.io/notes/index.xml" rel="self" type="application/rss+xml"/><item><title>G1 垃圾回收器（Garbage-First, G1 GC）</title><link>https://qtopie.github.io/notes/java/g1/</link><pubDate>Sun, 29 Jun 2025 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/java/g1/</guid><description>&lt;p&gt;G1 是 Java HotSpot 虚拟机自 JDK7u4 起提供的服务器端垃圾回收器，目标是替代 CMS，适用于大堆内存、低延迟场景。G1 通过分区、并发和自适应等机制，实现高吞吐量和可预测的停顿时间。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="g1-的主要特点"&gt;G1 的主要特点&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;分区管理（Region）&lt;/strong&gt;：将堆划分为多个大小相等的 Region，每个 Region 可作为 Eden、Survivor 或 Old 区，灵活管理内存。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;分代收集&lt;/strong&gt;：同时支持年轻代和老年代的垃圾收集。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;可预测停顿时间&lt;/strong&gt;：允许用户设置最大停顿时间目标（如 &lt;code&gt;-XX:MaxGCPauseMillis&lt;/code&gt;），G1 会自适应调整回收行为以尽量满足目标。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;并发与并行&lt;/strong&gt;：支持多线程并发标记和回收，减少 Stop-The-World（STW）时间。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;垃圾优先&lt;/strong&gt;：优先回收垃圾最多的 Region，提高回收效率。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;整体堆回收&lt;/strong&gt;：可对整个堆进行回收，避免碎片化。&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="g1-垃圾回收过程"&gt;G1 垃圾回收过程&lt;/h2&gt;
&lt;h3 id="触发条件"&gt;触发条件&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;年轻代空间不足时触发 Young GC。&lt;/li&gt;
&lt;li&gt;老年代空间不足或达到阈值时触发 Mixed GC 或 Full GC。&lt;/li&gt;
&lt;li&gt;显式调用 &lt;code&gt;System.gc()&lt;/code&gt; 可能触发 Full GC。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="回收阶段"&gt;回收阶段&lt;/h3&gt;
&lt;p&gt;G1 的回收阶段分为两类：&lt;strong&gt;Young Only GC&lt;/strong&gt; 和 &lt;strong&gt;Mixed GC&lt;/strong&gt;。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Young Only GC 阶段&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;仅回收年轻代（Eden 和 Survivor 区）的 Region。&lt;/li&gt;
&lt;li&gt;触发条件：年轻代空间不足。&lt;/li&gt;
&lt;li&gt;过程：采用并行回收，通常伴随初始标记（Initial Mark），会发生短暂的 STW（Stop-The-World）暂停。&lt;/li&gt;
&lt;li&gt;目标：快速回收短生命周期对象，腾出新生代空间。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="young-only-gc-的过程"&gt;Young Only GC 的过程&lt;/h3&gt;
&lt;p&gt;Young Only GC 主要针对年轻代（Eden 和 Survivor 区）的 Region 进行回收，流程如下：&lt;/p&gt;</description></item><item><title>ZGC</title><link>https://qtopie.github.io/notes/java/zgc/</link><pubDate>Sun, 29 Jun 2025 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/java/zgc/</guid><description>&lt;h2 id="zgc-简介"&gt;ZGC 简介&lt;/h2&gt;
&lt;p&gt;**ZGC（Z Garbage Collector）**是 Java HotSpot 虚拟机自 JDK 11 引入的一款可扩展、低延迟的垃圾回收器，专为大堆内存和对延迟极为敏感的应用场景设计。&lt;/p&gt;
&lt;h3 id="主要特点"&gt;主要特点&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;超低延迟&lt;/strong&gt;：GC 停顿时间通常不超过 1~2 毫秒，与堆大小几乎无关（即使 TB 级堆）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;并发回收&lt;/strong&gt;：大部分垃圾回收工作与应用线程并发进行，极大减少 Stop-The-World（STW）时间。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;可扩展性强&lt;/strong&gt;：支持超大堆（数 TB 级别），适合大数据、在线服务等场景。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Regionless 设计&lt;/strong&gt;：不像 G1 那样分 Region，ZGC 采用按需分配的内存块（Chunk），简化内存管理。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;着色指针（Colored Pointers）&lt;/strong&gt;：利用对象引用的高位存储元数据，实现高效的并发标记和转移。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="工作原理"&gt;工作原理&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;并发标记&lt;/strong&gt;：与应用线程并发，标记所有可达对象。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;并发重定位&lt;/strong&gt;：对象在后台被迁移到新内存，引用通过着色指针和读屏障自动修正。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;并发清理&lt;/strong&gt;：回收不可达对象占用的内存。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;极短暂停&lt;/strong&gt;：只有少量阶段（如初始标记、重新标记）会有极短的 STW 停顿。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="启用方式"&gt;启用方式&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;JDK 11+：&lt;code&gt;-XX:+UseZGC&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;JDK 15+ 支持 Windows/macOS&lt;/li&gt;
&lt;li&gt;常用参数：
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-Xmx&lt;/code&gt;、&lt;code&gt;-Xms&lt;/code&gt; 设置堆大小&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-XX:ConcGCThreads&lt;/code&gt; 并发 GC 线程数&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-XX:MaxGCPauseMillis&lt;/code&gt; 期望最大停顿时间&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="适用场景"&gt;适用场景&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;需要极低 GC 停顿的在线服务&lt;/li&gt;
&lt;li&gt;大内存、大对象、大吞吐量应用&lt;/li&gt;
&lt;li&gt;金融、电商、广告、实时分析等领域&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="zgc-的垃圾回收过程"&gt;ZGC 的垃圾回收过程&lt;/h2&gt;
&lt;p&gt;ZGC 的回收过程高度并发，主要分为以下几个阶段：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;初始标记（Initial Mark）&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;标记从 GC Roots 直接可达的对象。&lt;/li&gt;
&lt;li&gt;该阶段会有一次极短的 Stop-The-World（STW）暂停。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;并发标记（Concurrent Mark）&lt;/strong&gt;&lt;/p&gt;</description></item><item><title>JVM内存泄漏排查</title><link>https://qtopie.github.io/notes/java/jvm-memory-leaks/</link><pubDate>Sat, 23 Nov 2024 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/java/jvm-memory-leaks/</guid><description>&lt;h2 id="堆内存泄漏"&gt;堆内存泄漏&lt;/h2&gt;
&lt;p&gt;长生命周期的对象，持有短生命周期对象的引用，导致后者无法被 GC 回收。&lt;/p&gt;
&lt;p&gt;我们先来简单造一个典型的错误案例。我们有一个内存cache, 然后key是object类型&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#069;font-weight:bold"&gt;import&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#0cf;font-weight:bold"&gt;java.util.HashSet&lt;/span&gt;;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;&lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;import&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#0cf;font-weight:bold"&gt;java.util.Set&lt;/span&gt;;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;&lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;import&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#0cf;font-weight:bold"&gt;java.util.concurrent.TimeUnit&lt;/span&gt;;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;&lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;/**
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * 模拟由“可变哈希值”导致的内存泄漏
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * 场景：对象存入 HashSet/HashMap 后，修改了参与 hashCode 计算的字段，导致无法被删除。
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; */&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;&lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;public&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;class&lt;/span&gt; &lt;span style="color:#0a8;font-weight:bold"&gt;MutableKeyLeakDemo&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// 1. 静态容器，模拟全局缓存&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;private&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;static&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;final&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;Set&lt;span style="color:#555"&gt;&amp;lt;&lt;/span&gt;KeyObject&lt;span style="color:#555"&gt;&amp;gt;&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;LEAK_SET&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;new&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;HashSet&lt;span style="color:#555"&gt;&amp;lt;&amp;gt;&lt;/span&gt;();&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;/**
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * 定义一个“不守规矩”的 Key 对象
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; */&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;static&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;class&lt;/span&gt; &lt;span style="color:#0a8;font-weight:bold"&gt;KeyObject&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;private&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#078;font-weight:bold"&gt;int&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;id;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// 为了让内存占用明显，每个对象携带 50KB 数据&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;private&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#078;font-weight:bold"&gt;byte&lt;/span&gt;&lt;span style="color:#555"&gt;[]&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;payload&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;new&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#078;font-weight:bold"&gt;byte&lt;/span&gt;&lt;span style="color:#555"&gt;[&lt;/span&gt;50&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;*&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;1024&lt;span style="color:#555"&gt;]&lt;/span&gt;;&lt;span style="color:#bbb"&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;public&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#c0f"&gt;KeyObject&lt;/span&gt;(&lt;span style="color:#078;font-weight:bold"&gt;int&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;id)&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;this&lt;/span&gt;.&lt;span style="color:#309"&gt;id&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;id;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// 【致命操作】提供了一个 Setter 修改参与 Hash 计算的字段&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;public&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#078;font-weight:bold"&gt;void&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#c0f"&gt;setId&lt;/span&gt;(&lt;span style="color:#078;font-weight:bold"&gt;int&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;id)&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;this&lt;/span&gt;.&lt;span style="color:#309"&gt;id&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;id;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// hashCode 依赖于 id&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#99f"&gt;@Override&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;public&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#078;font-weight:bold"&gt;int&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#c0f"&gt;hashCode&lt;/span&gt;()&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;return&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;id;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// equals 也依赖于 id&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#99f"&gt;@Override&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;public&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#078;font-weight:bold"&gt;boolean&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#c0f"&gt;equals&lt;/span&gt;(Object&lt;span style="color:#bbb"&gt; &lt;/span&gt;o)&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;if&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;(&lt;span style="color:#069;font-weight:bold"&gt;this&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;==&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;o)&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;return&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;true&lt;/span&gt;;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;if&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;(o&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;==&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;null&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;||&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;getClass()&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;!=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;o.&lt;span style="color:#309"&gt;getClass&lt;/span&gt;())&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;return&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;false&lt;/span&gt;;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;KeyObject&lt;span style="color:#bbb"&gt; &lt;/span&gt;keyObject&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;(KeyObject)&lt;span style="color:#bbb"&gt; &lt;/span&gt;o;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;return&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;id&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;==&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;keyObject.&lt;span style="color:#309"&gt;id&lt;/span&gt;;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;public&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;static&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#078;font-weight:bold"&gt;void&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#c0f"&gt;main&lt;/span&gt;(String&lt;span style="color:#555"&gt;[]&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;args)&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;throws&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;InterruptedException&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;System.&lt;span style="color:#309"&gt;out&lt;/span&gt;.&lt;span style="color:#309"&gt;println&lt;/span&gt;(&lt;span style="color:#c30"&gt;&amp;#34;=== 应用程序启动 ===&amp;#34;&lt;/span&gt;);&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;System.&lt;span style="color:#309"&gt;out&lt;/span&gt;.&lt;span style="color:#309"&gt;println&lt;/span&gt;(&lt;span style="color:#c30"&gt;&amp;#34;请打开 VisualVM 连接... (等待 10 秒)&amp;#34;&lt;/span&gt;);&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;TimeUnit.&lt;span style="color:#309"&gt;SECONDS&lt;/span&gt;.&lt;span style="color:#309"&gt;sleep&lt;/span&gt;(10);&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;System.&lt;span style="color:#309"&gt;out&lt;/span&gt;.&lt;span style="color:#309"&gt;println&lt;/span&gt;(&lt;span style="color:#c30"&gt;&amp;#34;=== 开始测试：存入 -&amp;gt; 修改 -&amp;gt; 尝试删除 ===&amp;#34;&lt;/span&gt;);&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;for&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;(&lt;span style="color:#078;font-weight:bold"&gt;int&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;i&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;0;&lt;span style="color:#bbb"&gt; &lt;/span&gt;i&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;&amp;lt;&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;10000;&lt;span style="color:#bbb"&gt; &lt;/span&gt;i&lt;span style="color:#555"&gt;++&lt;/span&gt;)&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// A. 创建对象，此时 id = i (比如 0)&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;KeyObject&lt;span style="color:#bbb"&gt; &lt;/span&gt;key&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;new&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;KeyObject(i);&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// B. 放入 Set&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// Set 根据 hashCode(0) 把它放到了 &amp;#34;桶A&amp;#34; 里&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;LEAK_SET.&lt;span style="color:#309"&gt;add&lt;/span&gt;(key);&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// C. 【关键泄漏点】修改 id&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// 此时对象的 id 变成了 99999+i，hashCode 也变了！&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;key.&lt;span style="color:#309"&gt;setId&lt;/span&gt;(i&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;+&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;99999);&lt;span style="color:#bbb"&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// D. 尝试删除这个对象&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// Set 调用 key.hashCode()，算出的是新 ID 对应的 &amp;#34;桶B&amp;#34;。&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// Set 去 &amp;#34;桶B&amp;#34; 里找，当然找不到（因为对象其实还在 &amp;#34;桶A&amp;#34; 里躺着）。&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#078;font-weight:bold"&gt;boolean&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;success&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;LEAK_SET.&lt;span style="color:#309"&gt;remove&lt;/span&gt;(key);&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// 验证是否删除失败&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;if&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;(success)&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;System.&lt;span style="color:#309"&gt;out&lt;/span&gt;.&lt;span style="color:#309"&gt;println&lt;/span&gt;(&lt;span style="color:#c30"&gt;&amp;#34;删除成功 (这行代码永远不会执行)&amp;#34;&lt;/span&gt;);&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;}&lt;span style="color:#bbb"&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// 每 500 个打印一次日志，避免刷屏&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;if&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;(i&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;%&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;500&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;==&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;0)&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;System.&lt;span style="color:#309"&gt;out&lt;/span&gt;.&lt;span style="color:#309"&gt;println&lt;/span&gt;(&lt;span style="color:#c30"&gt;&amp;#34;尝试删除第 &amp;#34;&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;+&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;i&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;+&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34; 个对象 | 删除结果: &amp;#34;&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;+&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;(success&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;?&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;成功&amp;#34;&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;:&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;失败&amp;#34;&lt;/span&gt;)&lt;span style="color:#bbb"&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;+&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34; | 当前 Set 大小: &amp;#34;&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;+&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;LEAK_SET.&lt;span style="color:#309"&gt;size&lt;/span&gt;());&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;TimeUnit.&lt;span style="color:#309"&gt;MILLISECONDS&lt;/span&gt;.&lt;span style="color:#309"&gt;sleep&lt;/span&gt;(20);&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// 稍微停顿，观察内存曲线&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;System.&lt;span style="color:#309"&gt;out&lt;/span&gt;.&lt;span style="color:#309"&gt;println&lt;/span&gt;(&lt;span style="color:#c30"&gt;&amp;#34;=== 循环结束 ===&amp;#34;&lt;/span&gt;);&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// 理论上我们执行了 10000 次 add 和 10000 次 remove，Set 应该是空的。&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// 但实际上...&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;System.&lt;span style="color:#309"&gt;out&lt;/span&gt;.&lt;span style="color:#309"&gt;println&lt;/span&gt;(&lt;span style="color:#c30"&gt;&amp;#34;预期 Set 大小: 0&amp;#34;&lt;/span&gt;);&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;System.&lt;span style="color:#309"&gt;out&lt;/span&gt;.&lt;span style="color:#309"&gt;println&lt;/span&gt;(&lt;span style="color:#c30"&gt;&amp;#34;实际 Set 大小: &amp;#34;&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;+&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;LEAK_SET.&lt;span style="color:#309"&gt;size&lt;/span&gt;());&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;System.&lt;span style="color:#309"&gt;out&lt;/span&gt;.&lt;span style="color:#309"&gt;println&lt;/span&gt;(&lt;span style="color:#c30"&gt;&amp;#34;内存未释放，因为这些对象在 Set 中迷失了。&amp;#34;&lt;/span&gt;);&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// 保持运行以便 Dump&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;synchronized&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;(MutableKeyLeakDemo.&lt;span style="color:#309"&gt;class&lt;/span&gt;)&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;MutableKeyLeakDemo.&lt;span style="color:#309"&gt;class&lt;/span&gt;.&lt;span style="color:#309"&gt;wait&lt;/span&gt;();&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;&lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;如何避免这种泄漏？
铁律： 放入 HashMap/HashSet 的 Key 类，其参与 hashCode 和 equals 计算的字段必须是不可变（Immutable）的（即用 final 修饰）。&lt;/p&gt;</description></item><item><title>JVM线程分析</title><link>https://qtopie.github.io/notes/java/thread/</link><pubDate>Wed, 11 Sep 2024 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/java/thread/</guid><description>&lt;h2 id="线程的状态"&gt;线程的状态&lt;/h2&gt;
&lt;p&gt;参考定义 &lt;code&gt;java.lang.Thread.State&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#069;font-weight:bold"&gt;public&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;enum&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;State&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;/**
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * Thread state for a thread which has not yet started.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; */&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;NEW,&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;/**
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * Thread state for a runnable thread. A thread in the runnable
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * state is executing in the Java virtual machine but it may
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * be waiting for other resources from the operating system
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * such as processor.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; */&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;RUNNABLE,&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;/**
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * Thread state for a thread blocked waiting for a monitor lock.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * A thread in the blocked state is waiting for a monitor lock
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * to enter a synchronized block/method or
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * reenter a synchronized block/method after calling
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * {@link Object#wait() Object.wait}.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; */&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;BLOCKED,&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;/**
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * Thread state for a waiting thread.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * A thread is in the waiting state due to calling one of the
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * following methods:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * &amp;lt;ul&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * &amp;lt;li&amp;gt;{@link Object#wait() Object.wait} with no timeout&amp;lt;/li&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * &amp;lt;li&amp;gt;{@link #join() Thread.join} with no timeout&amp;lt;/li&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * &amp;lt;li&amp;gt;{@link LockSupport#park() LockSupport.park}&amp;lt;/li&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * &amp;lt;/ul&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; *
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * &amp;lt;p&amp;gt;A thread in the waiting state is waiting for another thread to
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * perform a particular action.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; *
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * For example, a thread that has called {@code Object.wait()}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * on an object is waiting for another thread to call
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * {@code Object.notify()} or {@code Object.notifyAll()} on
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * that object. A thread that has called {@code Thread.join()}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * is waiting for a specified thread to terminate.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; */&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;WAITING,&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;/**
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * Thread state for a waiting thread with a specified waiting time.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * A thread is in the timed waiting state due to calling one of
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * the following methods with a specified positive waiting time:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * &amp;lt;ul&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * &amp;lt;li&amp;gt;{@link #sleep Thread.sleep}&amp;lt;/li&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * &amp;lt;li&amp;gt;{@link Object#wait(long) Object.wait} with timeout&amp;lt;/li&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * &amp;lt;li&amp;gt;{@link #join(long) Thread.join} with timeout&amp;lt;/li&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * &amp;lt;li&amp;gt;{@link LockSupport#parkNanos LockSupport.parkNanos}&amp;lt;/li&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * &amp;lt;li&amp;gt;{@link LockSupport#parkUntil LockSupport.parkUntil}&amp;lt;/li&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * &amp;lt;/ul&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; */&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;TIMED_WAITING,&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;/**
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * Thread state for a terminated thread.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; * The thread has completed execution.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; */&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;TERMINATED;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;&lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre tabindex="0"&gt;&lt;code class="language-mermaid" data-lang="mermaid"&gt;stateDiagram
 [*] --&amp;gt; New
 New --&amp;gt; Runnable : start()
 Runnable --&amp;gt; Blocked : acquire monitor lock
 Runnable --&amp;gt; Waiting : wait(), join(), park()
 Runnable --&amp;gt; Timed Waiting : wait(timeout), join(timeout), parkNanos(timeout)
 Blocked --&amp;gt; Runnable : obtain monitor lock
 Waiting --&amp;gt; Runnable : signaled or interrupted
 Timed Waiting --&amp;gt; Runnable : time elapses
 Runnable --&amp;gt; Terminated : run() completes
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="waiting-vs-blocked"&gt;waiting vs blocked&lt;/h3&gt;
&lt;p&gt;blocked: 线程试图获取一个被其他线程持有的锁（monitor），但获取失败，导致线程被阻塞 被动进入 blocked 状态的&lt;/p&gt;</description></item><item><title>缓存过期</title><link>https://qtopie.github.io/notes/system-design/cache-expiration/</link><pubDate>Sat, 07 Sep 2024 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/system-design/cache-expiration/</guid><description>&lt;h2 id="缓存的模式"&gt;缓存的模式&lt;/h2&gt;
&lt;h2 id="参考"&gt;参考&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://hazelcast.com/blog/a-hitchhikers-guide-to-caching-patterns/"&gt;https://hazelcast.com/blog/a-hitchhikers-guide-to-caching-patterns/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>链表反转</title><link>https://qtopie.github.io/notes/codejam/list/reverse-list/</link><pubDate>Sat, 07 Sep 2024 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/codejam/list/reverse-list/</guid><description>&lt;h2 id="链表反转深入浅出"&gt;链表反转：深入浅出&lt;/h2&gt;
&lt;h3 id="链表反转是什么"&gt;链表反转是什么？&lt;/h3&gt;
&lt;p&gt;链表反转，顾名思义，就是将一个链表的节点顺序颠倒过来。例如，原本的链表是1-&amp;gt;2-&amp;gt;3-&amp;gt;4，反转后就变成4-&amp;gt;3-&amp;gt;2-&amp;gt;1。&lt;/p&gt;
&lt;h3 id="为什么需要链表反转"&gt;为什么需要链表反转？&lt;/h3&gt;
&lt;p&gt;链表反转是链表操作中一个非常基础且常见的操作，它在很多算法和数据结构中都有应用，比如：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;栈的实现：&lt;/strong&gt; 链表反转可以用来实现一个栈的数据结构。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;队列的实现：&lt;/strong&gt; 链表反转可以用来实现一个队列的数据结构。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;算法优化：&lt;/strong&gt; 有些算法中，通过链表反转可以优化时间或空间复杂度。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="链表反转的实现"&gt;链表反转的实现&lt;/h3&gt;
&lt;h4 id="迭代法"&gt;迭代法&lt;/h4&gt;
&lt;p&gt;迭代法是实现链表反转最常用的方法。其核心思想是：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;初始化三个指针：&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;prev&lt;/code&gt;: 指向当前节点的前一个节点&lt;/li&gt;
&lt;li&gt;&lt;code&gt;curr&lt;/code&gt;: 指向当前节点&lt;/li&gt;
&lt;li&gt;&lt;code&gt;next&lt;/code&gt;: 指向当前节点的后一个节点&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;遍历链表：&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;将 &lt;code&gt;curr&lt;/code&gt; 的 &lt;code&gt;next&lt;/code&gt; 指针指向 &lt;code&gt;prev&lt;/code&gt;，实现反转&lt;/li&gt;
&lt;li&gt;将 &lt;code&gt;prev&lt;/code&gt; 和 &lt;code&gt;curr&lt;/code&gt; 指针都向后移动一位&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;返回新的头节点：&lt;/strong&gt; 遍历结束后，&lt;code&gt;curr&lt;/code&gt; 指向新的头节点&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#069;font-weight:bold"&gt;func&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#c0f"&gt;reverseList&lt;/span&gt;(head&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;*&lt;/span&gt;ListNode)&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;*&lt;/span&gt;ListNode&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// 初始化第一个前驱指针指向null, 即为末端&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;var&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;prev&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;*&lt;/span&gt;ListNode&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;for&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;curr&lt;span style="color:#555"&gt;:=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;head;&lt;span style="color:#bbb"&gt; &lt;/span&gt;curr&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;!=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;nil&lt;/span&gt;;&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// 先用临时指针next保存下一个开始位置&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;next&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;:=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;curr.Next;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// 将当前指针指反转&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;curr.Next&lt;span style="color:#bbb"&gt; &lt;/span&gt;=&lt;span style="color:#bbb"&gt; &lt;/span&gt;prev;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// 移动指针&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;prev&lt;span style="color:#bbb"&gt; &lt;/span&gt;=&lt;span style="color:#bbb"&gt; &lt;/span&gt;curr;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;curr&lt;span style="color:#bbb"&gt; &lt;/span&gt;=&lt;span style="color:#bbb"&gt; &lt;/span&gt;next;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;return&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;prev;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;&lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="递归法"&gt;递归法&lt;/h4&gt;
&lt;p&gt;递归法是一种更加优雅的实现方式。其核心思想是：&lt;/p&gt;</description></item><item><title>树莓派和HomeAssistant</title><link>https://qtopie.github.io/notes/iot/rpi/homeassistant/</link><pubDate>Tue, 28 Sep 2021 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/iot/rpi/homeassistant/</guid><description>&lt;h2 id="目标"&gt;目标&lt;/h2&gt;
&lt;p&gt;使用开源软件和米家智能硬件，实现简单的智能家居系统&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;采用米家智能硬件的原因是, 小米智能家居做的比较早（也许是起初推广的更好，刚接触智能家居的时候就用的小米）,
另外一点是小米智能硬件确实物美价廉，在国外也很受欢迎，Github上也有很多相关项目.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src="homeassistant.assets/img-2021-10-16-12-14-50.png" alt=""&gt;&lt;/p&gt;
&lt;h2 id="环境和设备"&gt;环境和设备&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;RaspberryPi 4 (4GB版本)&lt;/li&gt;
&lt;li&gt;Ubuntu arm64 树莓派版本&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="安装homeassistant"&gt;安装HomeAssistant&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;这里使用Ubuntu而不是Raspbian的一个原因是Ubuntu官方软件包更新更快（比如raspbian当前为3.7而hass需要3.8+版本)，
且自己笔记本一直用Ubuntu，统一发行版使用起来更加方便&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo pip3 install homeassistant
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;如果下载很慢，可以考虑使用pypi镜像源&lt;/p&gt;
&lt;p&gt;编辑&lt;code&gt;/etc/pip.conf&lt;/code&gt; (使用豆瓣源）&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;[global]
index-url = https://pypi.douban.com/simple
&lt;/code&gt;&lt;/pre&gt;&lt;h4 id="设置开机自启动"&gt;设置开机自启动&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;创建systemd service unit文件&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;systemctl --user edit --full --force homeassistant.service
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;加入以下内容&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;[Unit]
Description=Home Assistant
After=network.target

[Service]
Type=simple
ExecStart=/home/ubuntu/.local/bin/hass
Restart=on-failure
RestartSec=5

[Install]
WantedBy=default.target
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;设置用户自动登录&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href="https://raspberrypi.stackexchange.com/questions/111728/how-to-get-raspi-config-on-ubuntu-20-04"&gt;安装&lt;code&gt;raspi-config&lt;/code&gt;&lt;/a&gt;,
然后配置 &lt;code&gt;1. System Options&lt;/code&gt; -&amp;gt; &lt;code&gt;S5 Boot / Auto Login&lt;/code&gt; -&amp;gt; &lt;code&gt;B2 Console Autologin&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;会生成&lt;code&gt;/etc/systemd/system/getty@tty1.service.d/autologin.conf&lt;/code&gt;, 内容如下&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;[Service]
ExecStart=
ExecStart=-/sbin/agetty --autologin ubuntu --noclear %I $TERM
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;重启即可生效&lt;/p&gt;</description></item><item><title>vim-go</title><link>https://qtopie.github.io/notes/vim/vim-go/</link><pubDate>Sat, 28 Aug 2021 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/vim/vim-go/</guid><description>&lt;p&gt;&lt;em&gt;将VIM打造为Go开发利器&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;平时一般使用VSCode编程，最近为了更好地刷leetcode，又换回了vim。发现笔记本小屏幕
使用vscode zen-mode沉浸式看代码很爽以后，也喜欢上了使用vim写代码, 快捷键方便、稳
定高效、功能纯粹（极简主义）。研究了一番后，发现其可行性，便整理了一下。&lt;/p&gt;
&lt;h2 id="主要插件"&gt;主要插件&lt;/h2&gt;
&lt;p&gt;完整列表&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-vim" data-lang="vim"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Plug &lt;span style="color:#c30"&gt;&amp;#39;scrooloose/nerdtree&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Plug &lt;span style="color:#c30"&gt;&amp;#39;preservim/tagbar&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Plug &lt;span style="color:#c30"&gt;&amp;#39;vim-airline/vim-airline&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Plug &lt;span style="color:#c30"&gt;&amp;#39;vim-airline/vim-airline-themes&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Plug &lt;span style="color:#c30"&gt;&amp;#39;fatih/vim-go&amp;#39;&lt;/span&gt;, { &lt;span style="color:#c30"&gt;&amp;#39;do&amp;#39;&lt;/span&gt;: &lt;span style="color:#c30"&gt;&amp;#39;:GoUpdateBinaries&amp;#39;&lt;/span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Plug &lt;span style="color:#c30"&gt;&amp;#39;Shougo/ddc.vim&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Plug &lt;span style="color:#c30"&gt;&amp;#39;vim-denops/denops.vim&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Plug &lt;span style="color:#c30"&gt;&amp;#39;buoto/gotests-vim&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Plug &lt;span style="color:#c30"&gt;&amp;#39;SirVer/ultisnips&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Plug &lt;span style="color:#c30"&gt;&amp;#39;honza/vim-snippets&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="vim-go"&gt;&lt;a href="https://github.com/fatih/vim-go"&gt;vim-go&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;vim-go&lt;/code&gt;是目前主要且流行的针对go的vim插件，视频[Hacking with Andrew and Brad: an HTTP/2 client]
(&lt;a href="https://www.youtube.com/watch?v=yG-UaBJXZ80"&gt;https://www.youtube.com/watch?v=yG-UaBJXZ80&lt;/a&gt;)中两位大佬用vim 进行pair编程使用了就是该插件。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;PS: 当时看了这视频后，不禁佩服两位大佬的代码功底，也刷新了使用vim开发实际项目的认知, 原来使用vim写代码
还可以比eclipse/idea/vscode更顺手, 也可以装酷了：》
自己用vim一般也只是用来改改配置，写写简单的脚本，还没尝试过使用它进行正经的项目开发。
虽然以前做过尝试，不过借助&lt;code&gt;vim-go&lt;/code&gt;插件和&lt;code&gt;LSP&lt;/code&gt;，这成为了真正的可能。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;虽然vim-go原作者已不再参与维护该项目，但已交给社区的另外两人负责，仍然在活跃更新
&lt;a href="https://arslan.io/2018/10/09/taking-an-indefinite-sabbatical-from-my-projects/"&gt;https://arslan.io/2018/10/09/taking-an-indefinite-sabbatical-from-my-projects/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/govim/govim"&gt;&lt;code&gt;govim&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;govim是一个有意思的vim插件，它&lt;a href="https://github.com/govim/govim/wiki/FAQ"&gt;尝试使用go语言编写vim插件&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;作为一个后起之秀，它的功能并没有&lt;code&gt;vim-go&lt;/code&gt;完善，比如debug功能（这对我来说是一个核心诉求）,
从实际使用体验来看，也不如&lt;code&gt;vim-go&lt;/code&gt;稳定。从个人角度而言, vim, go我都喜欢，但使用vim script
编写插件应该有更好的兼容性(vim对go的支持还没有那么的好，对lua和python的支持更佳）,
所以还是选择&lt;code&gt;vim-go&lt;/code&gt;插件。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;配置&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-vim" data-lang="vim"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;&amp;#34;.vim/after/ftplugin/go.vim &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;&amp;#34; shortcut like vscode&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;nnoremap &amp;lt;buffer&amp;gt; &amp;lt;silent&amp;gt; &amp;lt;F2&amp;gt; :hide GoRename&amp;lt;CR&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;nnoremap &amp;lt;buffer&amp;gt; &amp;lt;silent&amp;gt; &amp;lt;F4&amp;gt; :hide GoBuild&amp;lt;CR&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;nnoremap &amp;lt;buffer&amp;gt; &amp;lt;silent&amp;gt; &amp;lt;F5&amp;gt; :hide GoDebugStart&amp;lt;CR&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;nnoremap &amp;lt;buffer&amp;gt; &amp;lt;silent&amp;gt; &amp;lt;C-F5&amp;gt; :hide GoRun&amp;lt;CR&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;nnoremap &amp;lt;buffer&amp;gt; &amp;lt;silent&amp;gt; &amp;lt;S-F11&amp;gt; :hide GoDebugStepOut&amp;lt;CR&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;nnoremap &amp;lt;buffer&amp;gt; &amp;lt;silent&amp;gt; &amp;lt;F12&amp;gt; :hide GoDebugStop&amp;lt;CR&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src="vim-go.assets/img-2021-10-07-16-02-58.png" alt="vim-go debug"&gt;&lt;/p&gt;</description></item><item><title>排列组合</title><link>https://qtopie.github.io/notes/algorithms/combination-permutation/</link><pubDate>Thu, 15 Jul 2021 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/algorithms/combination-permutation/</guid><description>&lt;p&gt;&lt;strong&gt;This is a testing post for writing markdown with latex&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id="排列组合"&gt;排列组合&lt;/h1&gt;
&lt;h2 id="独立重复性事件"&gt;独立重复性事件&lt;/h2&gt;
&lt;h2 id="-nm"&gt;&lt;code&gt;\: n^m&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;从n个不同物品中取一个物品，每次取一个，取m次的结果（考虑先后顺序）&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-math" data-lang="math"&gt;n^m = n \times n \times n ... \times n \tag 1
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="-a_nn"&gt;&lt;code&gt;\: A_n^n&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;从n个不同物品中取一个物品，每次取一个, &lt;strong&gt;不放回&lt;/strong&gt;，取n次(完）的结果.（考虑先后顺序）&lt;/p&gt;
&lt;p&gt;第一次有n个结果， 依据独立性事件，第二次有n-1中结果，以此类推&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-math" data-lang="math"&gt;A_n^n = n(n-1)(n-2)... \times 2 \times 1 \tag 2
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="-a_nm"&gt;&lt;code&gt;\: A_n^m&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;从n个不同物品中取一个物品，每次取一个, &lt;strong&gt;不放回&lt;/strong&gt;，取m次(可能不取）的结果.（考虑先后顺序），未取到的结果有&lt;code&gt;\: A_{n-m}^{n-m}&lt;/code&gt;种&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-math" data-lang="math"&gt;A_n^m = \frac{A_n^n}{A_{n-m}^{n-m}} = n(n-1)(n-2)...(n-m+1) \tag 3
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="-c_nm"&gt;&lt;code&gt;\: C_n^m&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;从n个不同物品中取一个物品，每次取一个, &lt;strong&gt;不放回&lt;/strong&gt;，取m次(可能不取）的结果.（不考虑先后顺序）&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-math" data-lang="math"&gt;C_n^m = \frac{A_n^m}{A_m^m} = \frac{n!}{m! \times (n-m)!} \tag 4
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="例子"&gt;例子&lt;/h2&gt;
&lt;p&gt;3 * 4 的格子, 从左上走到右下角，只能往下或者往右。&lt;/p&gt;</description></item><item><title>Linux Command-line Handbook</title><link>https://qtopie.github.io/notes/linux/linux-cmd-handbook/</link><pubDate>Sun, 02 May 2021 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/linux/linux-cmd-handbook/</guid><description>&lt;p&gt;&lt;em&gt;Based on my experiences on Ubuntu&lt;/em&gt;&lt;/p&gt;
&lt;h2 id="software-package-management"&gt;Software Package Management&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;set up proxy for apt&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo bash -c &lt;span style="color:#c30"&gt;&amp;#39;cat &amp;lt;&amp;lt; EOF &amp;gt; /etc/apt/apt.conf.d/proxy.conf
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c30"&gt;Acquire {
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c30"&gt; HTTP::proxy &amp;#34;http://127.0.0.1:8118&amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c30"&gt; HTTPS::proxy &amp;#34;http://127.0.0.1:8118&amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c30"&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c30"&gt;EOF&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="system-monitoring"&gt;System Monitoring&lt;/h2&gt;
&lt;h3 id="basic-info"&gt;Basic Info&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# memory&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;free -m 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# get process id&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;ps aux | grep &amp;lt;pattern&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# view startup command of process&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;ps flww -p &lt;span style="color:#555"&gt;[&lt;/span&gt;PID&lt;span style="color:#555"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# check cpu usage&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;top -p &amp;lt;pid&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# list by threads&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;top -H -p &amp;lt;pid&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# disk&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;df -h
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# networks&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;iostat
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="performance-testing"&gt;Performance Testing&lt;/h2&gt;
&lt;h3 id="network-bindwidth-testing"&gt;Network Bindwidth Testing&lt;/h3&gt;
&lt;p&gt;There are two common means to achive this&lt;/p&gt;</description></item><item><title>VIM安装笔记</title><link>https://qtopie.github.io/notes/vim/build-and-install-latest-vim/</link><pubDate>Tue, 06 Apr 2021 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/vim/build-and-install-latest-vim/</guid><description>&lt;h1 id="vim-安装"&gt;VIM 安装&lt;/h1&gt;
&lt;p&gt;由于debian发行版维护的vim包还未升级到最新版本，但govim需要较高版本的vim。故选择手动编译安装。这里直接选择最新版本8.2， 对应于最新的git tag版本， &lt;a href="https://www.vim.org/vim-8.2-released.php"&gt;8.2版本有一些实用性的功能&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;环境&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Ubuntu 19.10&lt;/li&gt;
&lt;li&gt;5.3.0-24-generic x84_64&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="构建及安装过程"&gt;构建及安装过程&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;安装构建工具链&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo apt update &lt;span style="color:#555"&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo apt install -y git build-essential
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start="2"&gt;
&lt;li&gt;拉取源码&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;git clone https://github.com/vim/vim.git
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# 切换到你想构建的tag&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;git checkout v8.2.0369
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start="3"&gt;
&lt;li&gt;开始构建&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;#cd src&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;#make distclean # if you build Vim before&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;./configure --with-features&lt;span style="color:#555"&gt;=&lt;/span&gt;huge &lt;span style="color:#c30;font-weight:bold"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c30;font-weight:bold"&gt;&lt;/span&gt; --enable-multibyte &lt;span style="color:#c30;font-weight:bold"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c30;font-weight:bold"&gt;&lt;/span&gt; --enable-python3interp&lt;span style="color:#555"&gt;=&lt;/span&gt;yes &lt;span style="color:#c30;font-weight:bold"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c30;font-weight:bold"&gt;&lt;/span&gt; --with-python3-config-dir&lt;span style="color:#555"&gt;=&lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;$(&lt;/span&gt;python3-config --configdir&lt;span style="color:#069;font-weight:bold"&gt;)&lt;/span&gt; &lt;span style="color:#c30;font-weight:bold"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c30;font-weight:bold"&gt;&lt;/span&gt; --enable-perlinterp&lt;span style="color:#555"&gt;=&lt;/span&gt;yes &lt;span style="color:#c30;font-weight:bold"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c30;font-weight:bold"&gt;&lt;/span&gt; --enable-luainterp&lt;span style="color:#555"&gt;=&lt;/span&gt;yes &lt;span style="color:#c30;font-weight:bold"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c30;font-weight:bold"&gt;&lt;/span&gt; --enable-cscope &lt;span style="color:#c30;font-weight:bold"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#c30;font-weight:bold"&gt;&lt;/span&gt; --prefix&lt;span style="color:#555"&gt;=&lt;/span&gt;/usr/local
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;make &lt;span style="color:#033"&gt;VIMRUNTIMEDIR&lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;/usr/local/share/vim/vim82
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo apt install checkinstall
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo checkinstall
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;checkinstall&lt;/code&gt;执行完后，会安装到&lt;code&gt;/usr/local/bin/vim&lt;/code&gt; 即可。&lt;/p&gt;</description></item><item><title>自动控制风扇温度</title><link>https://qtopie.github.io/notes/iot/rpi/fan-and-tempature/</link><pubDate>Mon, 03 Aug 2020 23:33:04 +0800</pubDate><guid>https://qtopie.github.io/notes/iot/rpi/fan-and-tempature/</guid><description>&lt;p&gt;最近购买了一个树莓派4B 4G内存版，替换了旧的Model3 (强迫症犯了，就为了换成type c口，但因为电源适配问题还是老老实实地又买了官方电源适配器）&lt;/p&gt;
&lt;p&gt;树莓派4B相对3B性能提高不少，但是随之功耗和发热也上去了。 于是给它整了个金属外壳&lt;/p&gt;
&lt;p&gt;&lt;img src="fan-and-tempature.assets/img-20211029155258.webp" alt=""&gt;&lt;/p&gt;
&lt;p&gt;但是依旧烫得厉害，可能是我手动overlock了。开风扇的话，又有点吵，晚上影响睡觉。&lt;/p&gt;
&lt;p&gt;所以又买了一些排线和一个电磁继电器来实现自动通过风扇控制CPU等芯片温度。&lt;/p&gt;
&lt;h2 id="主要原理"&gt;主要原理&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;获取GPU温度&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href="https://www.nicm.dev/vcgencmd/"&gt;vcgencmd&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;vcgencmd measure_temp
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;获取CPU温度&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#033"&gt;cpu&lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;$(&lt;/span&gt;&amp;lt;/sys/class/thermal/thermal_zone0/temp&lt;span style="color:#069;font-weight:bold"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#366"&gt;echo&lt;/span&gt; &lt;span style="color:#c30"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;$((&lt;/span&gt;cpu/1000&lt;span style="color:#069;font-weight:bold"&gt;))&lt;/span&gt;&lt;span style="color:#c30"&gt; c&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="代码实现"&gt;代码实现&lt;/h2&gt;
&lt;p&gt;网上已经有不少python版本的实现，但作为一个go粉，当然选择用go来实现了，正好练习一下gobot包的使用&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-go" data-lang="go"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#069;font-weight:bold"&gt;package&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;main&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;&lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;import&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;(&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;time&amp;#34;&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;gobot.io/x/gobot&amp;#34;&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;gobot.io/x/gobot/drivers/gpio&amp;#34;&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;gobot.io/x/gobot/platforms/raspi&amp;#34;&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;io/ioutil&amp;#34;&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;log&amp;#34;&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;strconv&amp;#34;&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;strings&amp;#34;&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;&lt;/span&gt;)&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;&lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;func&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#c0f"&gt;main&lt;/span&gt;()&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;low,&lt;span style="color:#bbb"&gt; &lt;/span&gt;high&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;:=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#f60"&gt;50&lt;/span&gt;,&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#f60"&gt;58&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;r&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;:=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;raspi.&lt;span style="color:#c0f"&gt;NewAdaptor&lt;/span&gt;()&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;sw&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;:=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;gpio.&lt;span style="color:#c0f"&gt;NewDirectPinDriver&lt;/span&gt;(r,&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;18&amp;#34;&lt;/span&gt;)&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;work&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;:=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;func&lt;/span&gt;()&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;		&lt;/span&gt;gobot.&lt;span style="color:#c0f"&gt;Every&lt;/span&gt;(&lt;span style="color:#f60"&gt;5&lt;/span&gt;&lt;span style="color:#555"&gt;*&lt;/span&gt;time.Second,&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;func&lt;/span&gt;()&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;			&lt;/span&gt;t&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;:=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#c0f"&gt;readCpuTemp&lt;/span&gt;()&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;			&lt;/span&gt;log.&lt;span style="color:#c0f"&gt;Println&lt;/span&gt;(&lt;span style="color:#c30"&gt;&amp;#34;Temp&amp;#34;&lt;/span&gt;,&lt;span style="color:#bbb"&gt; &lt;/span&gt;t&lt;span style="color:#555"&gt;/&lt;/span&gt;&lt;span style="color:#f60"&gt;1000&lt;/span&gt;)&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;			&lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;if&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;t&lt;span style="color:#bbb"&gt; &lt;/span&gt;&amp;lt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;low&lt;span style="color:#555"&gt;*&lt;/span&gt;&lt;span style="color:#f60"&gt;1000&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;				&lt;/span&gt;sw.&lt;span style="color:#c0f"&gt;Off&lt;/span&gt;()&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;			&lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;			&lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;if&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;t&lt;span style="color:#bbb"&gt; &lt;/span&gt;&amp;gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;high&lt;span style="color:#555"&gt;*&lt;/span&gt;&lt;span style="color:#f60"&gt;1000&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// turn on only ater 7 oclock&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;				&lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;if&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;h,&lt;span style="color:#bbb"&gt; &lt;/span&gt;_,&lt;span style="color:#bbb"&gt; &lt;/span&gt;_&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;:=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;time.&lt;span style="color:#c0f"&gt;Now&lt;/span&gt;().&lt;span style="color:#c0f"&gt;Clock&lt;/span&gt;();&lt;span style="color:#bbb"&gt; &lt;/span&gt;h&lt;span style="color:#bbb"&gt; &lt;/span&gt;&amp;gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#f60"&gt;7&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;					&lt;/span&gt;sw.&lt;span style="color:#c0f"&gt;On&lt;/span&gt;()&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;				&lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;			&lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;		&lt;/span&gt;})&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;robot&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;:=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;gobot.&lt;span style="color:#c0f"&gt;NewRobot&lt;/span&gt;(&lt;span style="color:#c30"&gt;&amp;#34;blinkBot&amp;#34;&lt;/span&gt;,&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;		&lt;/span&gt;[]gobot.Connection{r},&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;		&lt;/span&gt;[]gobot.Device{sw},&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;		&lt;/span&gt;work,&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;)&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;robot.&lt;span style="color:#c0f"&gt;Start&lt;/span&gt;()&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;&lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;&lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;func&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#c0f"&gt;readCpuTemp&lt;/span&gt;()&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#078;font-weight:bold"&gt;int&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;var&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;na&lt;span style="color:#bbb"&gt; &lt;/span&gt;=&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;-&lt;/span&gt;&lt;span style="color:#f60"&gt;274150&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// set not valid value to -274.15C&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;dat,&lt;span style="color:#bbb"&gt; &lt;/span&gt;err&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;:=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;ioutil.&lt;span style="color:#c0f"&gt;ReadFile&lt;/span&gt;(&lt;span style="color:#c30"&gt;&amp;#34;/sys/class/thermal/thermal_zone0/temp&amp;#34;&lt;/span&gt;)&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;if&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;err&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;!=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;nil&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;		&lt;/span&gt;log.&lt;span style="color:#c0f"&gt;Println&lt;/span&gt;(err)&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;		&lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;return&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;na&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;s&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;:=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;strings.&lt;span style="color:#c0f"&gt;TrimSuffix&lt;/span&gt;(&lt;span style="color:#366"&gt;string&lt;/span&gt;(dat),&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;\n&amp;#34;&lt;/span&gt;)&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;t,&lt;span style="color:#bbb"&gt; &lt;/span&gt;err&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;:=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;strconv.&lt;span style="color:#c0f"&gt;Atoi&lt;/span&gt;(s)&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;if&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;err&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#555"&gt;!=&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;nil&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;		&lt;/span&gt;log.&lt;span style="color:#c0f"&gt;Println&lt;/span&gt;(err)&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;		&lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;return&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;na&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;	&lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;return&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;t&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;&lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;实现的效果是，当温度高于58度时，启动风扇；温度低于50度时关闭风扇。(风扇一直不停转，大概也只能到45度左右，可能深圳有点热）&lt;/p&gt;</description></item><item><title>Yarn</title><link>https://qtopie.github.io/notes/web/yarn/</link><pubDate>Sat, 20 Jun 2020 22:44:03 +0800</pubDate><guid>https://qtopie.github.io/notes/web/yarn/</guid><description>&lt;p&gt;&lt;a href="https://yarnpkg.com/"&gt;Yarn&lt;/a&gt;是Facebook、Google等主导开发的新的Javascript包管理器。（相对于npm)&lt;/p&gt;
&lt;h2 id="安装"&gt;&lt;a href="https://yarnpkg.com/getting-started/install"&gt;安装&lt;/a&gt;&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo npm install -g yarn --registry https://registry.npm.taobao.org
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这里使用了&lt;a href="https://developer.aliyun.com/mirror/NPM?from=tnpm"&gt;taobao npm镜像&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;配置Angular Cli使用yarn&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;使用ng命令设置全局使用yarn&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;ng config -g cli.packageManager yarn
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="使用"&gt;使用&lt;/h2&gt;
&lt;p&gt;添加依赖&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;yarn add &amp;lt;DEP_NAME&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# dev&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;yarn add -D &amp;lt;DEP_NAME&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;参考工具自带帮助文档&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;yarn --help
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="包下载缓存"&gt;&lt;a href="https://classic.yarnpkg.com/en/docs/cli/cache/"&gt;包下载缓存&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;可以通过设置环境变量&lt;code&gt;YARN_CACHE_FOLDER&lt;/code&gt;来指定缓存目录&lt;/p&gt;
&lt;p&gt;Ubuntu下修改&lt;code&gt;~/.bashrc&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#366"&gt;echo&lt;/span&gt; &lt;span style="color:#c30"&gt;&amp;#39;YARN_CACHE_FOLDER=$HOME/.yarn&amp;#39;&lt;/span&gt; &amp;gt;&amp;gt; ~/.bashrc
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="构建速度简单比较"&gt;构建速度简单比较&lt;/h3&gt;
&lt;p&gt;使用项目&lt;a href="https://github.com/artificerpi/tour-of-heroes"&gt;tour-of-heroes&lt;/a&gt;安装nodejs依赖。&lt;/p&gt;
&lt;p&gt;镜像: &lt;a href="https://registry.npm.taobao.org"&gt;https://registry.npm.taobao.org&lt;/a&gt;&lt;/p&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;NPM (6.14.5)&lt;/th&gt;
 &lt;th&gt;Yarn (1.22.4)&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;real	0m26.231s&lt;/td&gt;
 &lt;td&gt;real 0m14.048s&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;user	0m31.685s&lt;/td&gt;
 &lt;td&gt;user	0m15.415s&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;sys	 0m5.247s&lt;/td&gt;
 &lt;td&gt;sys	0m5.666s&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;可以看到yarn明显要快一些。
类似于npm安装依赖时创建&lt;code&gt;package-lock.json&lt;/code&gt;文件，yarn也会创建&lt;code&gt;yarn.lock&lt;/code&gt;文件锁定依赖。（这时安装已有包换registry会不生效)&lt;/p&gt;
&lt;h3 id="包下载镜像"&gt;包下载镜像&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#033"&gt;SASS_BINARY_SITE&lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;https://npm.taobao.org/mirrors/node-sass/
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#033"&gt;PHANTOMJS_CDNURL&lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;https://npm.taobao.org/mirrors/phantomjs/
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#033"&gt;ELECTRON_MIRROR&lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;https://npm.taobao.org/mirrors/electron/
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;可以自己搭建一个镜像，解决内网防火墙内无法下载包的问题&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;使用Caddy反向代理taobao镜像&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-Caddyfile" data-lang="Caddyfile"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#030;font-weight:bold"&gt;:8080&lt;/span&gt; {&lt;span style="color:#09f;font-style:italic"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; # https://npm.taobao.org/mirrors/node-sass/
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;&lt;/span&gt; &lt;span style="color:#069;font-weight:bold"&gt;route&lt;/span&gt; &lt;span style="color:#99f"&gt;/dist/node-sass/*&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#069;font-weight:bold"&gt;reverse_proxy&lt;/span&gt; &lt;span style="color:#c30"&gt;https://cdn.npm.taobao.org&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#069;font-weight:bold"&gt;header_up&lt;/span&gt; &lt;span style="color:#c30"&gt;Host&lt;/span&gt; &lt;span style="color:#c30;font-weight:bold"&gt;{http.reverse_proxy.upstream.hostport}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }&lt;span style="color:#09f;font-style:italic"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt; # https://npm.taobao.org/mirrors/phantomjs/
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;&lt;/span&gt; &lt;span style="color:#069;font-weight:bold"&gt;reverse_proxy&lt;/span&gt; &lt;span style="color:#99f"&gt;/dist/phantomjs/*&lt;/span&gt; &lt;span style="color:#c30"&gt;https://cdn.npm.taobao.org&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#069;font-weight:bold"&gt;header_up&lt;/span&gt; &lt;span style="color:#c30"&gt;Host&lt;/span&gt; &lt;span style="color:#c30;font-weight:bold"&gt;{http.reverse_proxy.upstream.hostport}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;node-sass 离线安装&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;下载地址 &lt;a href="https://github.com/sass/node-sass/releases"&gt;https://github.com/sass/node-sass/releases&lt;/a&gt;&lt;/p&gt;</description></item><item><title>win10下的应用容器化开发</title><link>https://qtopie.github.io/notes/cloud-native/k8s/container-dev-on-win10/</link><pubDate>Mon, 01 Jun 2020 21:15:34 +0800</pubDate><guid>https://qtopie.github.io/notes/cloud-native/k8s/container-dev-on-win10/</guid><description>&lt;p&gt;相对于Linux对容器化开发的良好支持（或者说各个容器化平台和工具对Linux更好的支持），在Windows下对应用进行容器化改造时的本地构建和测试并不是很直接和方便。这里记录一下，针对不同场景的相关实践经验。&lt;/p&gt;
&lt;h2 id="目标"&gt;目标&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;支持docker构建&lt;/li&gt;
&lt;li&gt;支持kubernetes容器服务编排&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="wsl"&gt;WSL&lt;/h2&gt;
&lt;p&gt;WSL (Windows subsystem for Linux) 是win10新增的一个功能，可以直接在Windows上运行本机Linux命令工具。之前大家一般会去用Cgwin (或MingGw)工具。&lt;/p&gt;
&lt;p&gt;WSL 提供一个名为 Bash.exe 的应用程序，启动该应用程序后，会打开一个运行 Bash shell 的 Windows 控制台。 使用 Bash 可以运行命令行 Linux 工具和应用。&lt;/p&gt;
&lt;p&gt;具体介绍可以参考微软提供的&lt;a href="https://docs.microsoft.com/zh-cn/windows/wsl/"&gt;WSL文档&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;WSL1 并没有一个完整的Linux内核，系统调用使用Windows Pico进程使用驱动翻译成NT API模拟成Linux内核的。具体架构可以参考&lt;a href="https://docs.microsoft.com/zh-cn/archive/blogs/wsl/windows-subsystem-for-linux-overview"&gt;WSL的系统架构&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;最近&lt;a href="https://docs.microsoft.com/en-us/windows/wsl/compare-versions"&gt;更新的WSL&lt;/a&gt;引入了微软提供的一个完整的Linux内核，增强了文件IO性能及完整的系统调用兼容性。这也意味着我们可以通过WSL2以Linux中的方式运行docker和kubernetes （这里我们使用microk8s)。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Windows下可直接使用WSL里Linux命令， 如&lt;code&gt;netstat -an | wsl grep :8443&lt;/code&gt;, 在pipe后面加上wsl即可&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="适用场景"&gt;适用场景&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;版本要求&lt;/p&gt;
&lt;p&gt;Win10 Version 2004, Build 19041 + （目前需要加入每月更新的预览版计划）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Hyper V支持 （需要Windows支持，同时需要设备支持硬件虚拟化)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="优点"&gt;优点&lt;/h4&gt;
&lt;p&gt;与Windows命令窗口和文件系统无缝集成，开发起来十分方便。在当前窗口输入&lt;code&gt;bash&lt;/code&gt;就可以进入Linux下对应的目录；同时还有VSCode Remote WSL的支持。&lt;/p&gt;
&lt;h3 id="安装配置"&gt;安装配置&lt;/h3&gt;
&lt;p&gt;启用Hyper V和Linux子系统&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux -NoRestart
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Enable-WindowsOptionalFeature -Online -FeatureName VirtualMachinePlatform
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;然后重启&lt;/p&gt;</description></item><item><title>Helm</title><link>https://qtopie.github.io/notes/cloud-native/k8s/helm.zh/</link><pubDate>Wed, 20 May 2020 21:15:34 +0800</pubDate><guid>https://qtopie.github.io/notes/cloud-native/k8s/helm.zh/</guid><description>&lt;p&gt;这里我们使用helm 3.0+版本, 可以直接使用kube-server api, 不需要在集群安装tiler&lt;/p&gt;
&lt;h2 id="安装"&gt;安装&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo snap install helm --classic
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="chartmuseum"&gt;Chartmuseum&lt;/h2&gt;
&lt;p&gt;repo: &lt;a href="https://github.com/helm/chartmuseum"&gt;https://github.com/helm/chartmuseum&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;本地安装&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;curl -LO https://s3.amazonaws.com/chartmuseum/release/latest/bin/linux/amd64/chartmuseum
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;chmod +x chartmuseum
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo mv chartmuseum /usr/bin/
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo mkdir /opt/chart &lt;span style="color:#555"&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo chown &lt;span style="color:#033"&gt;$USER&lt;/span&gt; /opt/chart
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;./chartmuseum --storage&lt;span style="color:#555"&gt;=&lt;/span&gt;&lt;span style="color:#366"&gt;local&lt;/span&gt; --storage-local-rootdir&lt;span style="color:#555"&gt;=&lt;/span&gt;/opt/chart
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;然后打开http://localhost:8080就可以看到欢迎界面&lt;/p&gt;
&lt;h2 id="创建和使用chart"&gt;创建和使用chart&lt;/h2&gt;
&lt;p&gt;我们以创建一个nginx chart为例。&lt;/p&gt;
&lt;p&gt;使用helm创建初始化配。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;mkdir app
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;helm create chart
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;然后可以看到初始化的以下配置&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;artificerpi@ky-laptop:~/build/app$ tree chart
chart
├── charts
├── Chart.yaml
├── templates
│   ├── deployment.yaml
│   ├── _helpers.tpl
│   ├── ingress.yaml
│   ├── NOTES.txt
│   ├── serviceaccount.yaml
│   ├── service.yaml
│   └── tests
│   └── test-connection.yaml
└── values.yaml

3 directories, 9 files
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;修改chart/Chart.yaml文件，将name字段改为&lt;code&gt;nginx-foo&lt;/code&gt;&lt;/p&gt;</description></item><item><title>JenkinsX</title><link>https://qtopie.github.io/notes/cloud-native/cicd/jenkinsx.zh/</link><pubDate>Tue, 28 Apr 2020 21:15:34 +0800</pubDate><guid>https://qtopie.github.io/notes/cloud-native/cicd/jenkinsx.zh/</guid><description>&lt;p&gt;Jenkins是一款比较经典而优秀的流水线构建工具（平台）。&lt;/p&gt;
&lt;p&gt;为了实现现代化构建方式Run configuration as Code, Jenkins引入了Blue Ocean插件。通过该插件，我们可以使用声明式语法来编写Jenkinsfile，定义流水线构建步骤 &lt;a href="https://www.jenkins.io/zh/doc/book/pipeline/jenkinsfile/"&gt;https://www.jenkins.io/zh/doc/book/pipeline/jenkinsfile/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;然而在云原生和DevOps越来越流行的今天，传统的Jenkins模式只能满足CI的构建需求。于是Jenkins团队又引入了&lt;a href="https://jenkins-x.io/"&gt;JenkinsX&lt;/a&gt;, 来实现一个现代化的GitOps平台。&lt;/p&gt;
&lt;p&gt;&lt;em&gt;emm, 不吹水了，其实我只想做个笔记,记录下折腾了很久后的才明白的安装步骤&lt;/em&gt;&lt;/p&gt;
&lt;h2 id="目标"&gt;目标&lt;/h2&gt;
&lt;p&gt;使用jx工具在microk8s上安装jenkinsx&lt;/p&gt;
&lt;p&gt;&lt;a href="https://jenkins-x.io/docs/labs/"&gt;https://jenkins-x.io/docs/labs/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;因为不喜欢使用helm2在k8s上安装tiller, 所以这里直接跳级到helm3。不过这里就要使用JenkinsX Lab里的jxl工具了。(目前是实验性版本的jenkinsx，意味着要花更多时间折腾)&lt;/p&gt;
&lt;p&gt;结果：暂时弃坑了，直接上tektoncd&lt;/p&gt;
&lt;h2 id="安装"&gt;安装&lt;/h2&gt;
&lt;p&gt;jxl本身使用gitops方式维护JenkinsX集群&lt;/p&gt;
&lt;h3 id="jxl-安装"&gt;jxl 安装&lt;/h3&gt;
&lt;p&gt;从这个链接下载安装jxl工具 &lt;a href="https://github.com/jenkins-x-labs/jxl/releases"&gt;https://github.com/jenkins-x-labs/jxl/releases&lt;/a&gt;&lt;/p&gt;
&lt;h3 id="创建仓库"&gt;创建仓库&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;jxl boot create
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这里我们选择minikube，和microk8s应该差不多。(注意不要选择更新本地jx版本，至少这篇文章写的时候这一步还有bug)&lt;/p&gt;
&lt;p&gt;按提示输入完毕就会初始化仓库，把jenkins bot的token记录下来, 我偷懒直接用这个访问github 私有仓库（开起了两步验证，直接使用密码没有办法直接推代码到github)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;这里还有一步是设置secret, 建议使用Hashicorp Vault存储secrets信息。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="安装启动"&gt;安装启动&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;拉取远程配置启动&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;jxl boot run --git-url https://github.com/artificerpi/environment-jx-dev --git-user artificerpi --git-token &amp;lt;TOKEN&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;本地启动 （只是一个测试）&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#366"&gt;cd&lt;/span&gt; environment-jx-dev &lt;span style="color:#555"&gt;&amp;amp;&amp;amp;&lt;/span&gt; jxl boot run -b
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;目前无法运行起来，报错&lt;code&gt;/secrets/jx-boot/secrets.yaml&lt;/code&gt;无法找到，可能是个bug&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-log" data-lang="log"&gt;error: failed to load secrets YAML /secrets/jx-boot/secrets.yaml: open /secrets/jx-boot/secrets.yaml: no such file or directory
&lt;/code&gt;&lt;/pre&gt;</description></item><item><title>Caddy与http3</title><link>https://qtopie.github.io/notes/web/caddy/</link><pubDate>Wed, 22 Apr 2020 00:03:52 +0800</pubDate><guid>https://qtopie.github.io/notes/web/caddy/</guid><description>&lt;h2 id="caddy-简单介绍"&gt;Caddy 简单介绍&lt;/h2&gt;
&lt;p&gt;Caddy是现代化的web代理服务器，使用Go语言编写，不直接依赖系统底层库。
另外，它很好地支持了https (也最先支持了http3), 而且它使用了现代化流行且安全的配置，几乎不需要额外配置。&lt;/p&gt;
&lt;h2 id="安装使用"&gt;安装使用&lt;/h2&gt;
&lt;p&gt;我们可以去官网下载2.0版本 &lt;a href="https://caddyserver.com/"&gt;https://caddyserver.com/&lt;/a&gt; 我们只需要拿到二进制文件即可。&lt;/p&gt;
&lt;p&gt;下载后放到&lt;code&gt;/usr/local/bin/caddy&lt;/code&gt;, 然后编辑Caddyfile&lt;/p&gt;
&lt;p&gt;/etc/Caddyfile&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;{
 # debug
 servers {
 protocol {
	 experimental_http3
 }
 }
}

www.mwine.science {
 # redirect www.mwine.science to mwine.science
	redir https://mwine.science{uri}
}

mwine.science {
	root * /var/www/html/mwine.science
	file_server
	encode zstd gzip 
}
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;配置参考 &lt;a href="https://caddyserver.com/docs/caddyfile/options"&gt;https://caddyserver.com/docs/caddyfile/options&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这里我将域名&lt;code&gt;mwine.science&lt;/code&gt;和&lt;code&gt;www.mwine.science&lt;/code&gt;绑定到了同一台服务器，并将&lt;code&gt;www.mwine.science&lt;/code&gt;重定向到&lt;code&gt;mwine.science&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;然后创建一个文件&lt;code&gt;/var/www/html/mwine.science/index.html&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-html" data-lang="html"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#099"&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&amp;lt;&lt;span style="color:#309;font-weight:bold"&gt;html&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&amp;lt;&lt;span style="color:#309;font-weight:bold"&gt;body&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; Hello World !
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&amp;lt;/&lt;span style="color:#309;font-weight:bold"&gt;body&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&amp;lt;/&lt;span style="color:#309;font-weight:bold"&gt;html&lt;/span&gt;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;最后运行起来就可以了 （这里我加上了watch选项，启用根据文件配置动态更新）&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/usr/local/bin/caddy run -config /etc/Caddyfile -watch
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;或者我们可以将它写成systemd服务，输入命令编辑&lt;code&gt;sudo systemctl edit --force --full caddy.service&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;粘贴以下内容&lt;/p&gt;</description></item><item><title>Go安装</title><link>https://qtopie.github.io/notes/go/setup-go/</link><pubDate>Wed, 18 Mar 2020 22:02:05 +0800</pubDate><guid>https://qtopie.github.io/notes/go/setup-go/</guid><description>&lt;p&gt;官方下载安装向导请参考这里https://golang.org/dl/&lt;/p&gt;
&lt;p&gt;这篇文章主要分享加速访问go依赖和资源站点的问题。&lt;/p&gt;
&lt;h2 id="环境"&gt;环境&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Ubuntu 19.10 x86_64&lt;/li&gt;
&lt;li&gt;版本号 go1.14 linux/amd64&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="下载安装"&gt;下载安装&lt;/h2&gt;
&lt;p&gt;Go安装文件可以访问国内站点 &lt;a href="https://golang.google.cn/dl/"&gt;https://golang.google.cn/dl/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;解压后，移动到&lt;code&gt;/usr/local/go&lt;/code&gt;目录，然后在&lt;code&gt;/etc/profile&lt;/code&gt;里加入&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#366"&gt;export&lt;/span&gt; &lt;span style="color:#033"&gt;GOROOT&lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;/usr/local/go
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#366"&gt;export&lt;/span&gt; &lt;span style="color:#033"&gt;PATH&lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;&lt;span style="color:#033"&gt;$PATH&lt;/span&gt;:&lt;span style="color:#033"&gt;$GOROOT&lt;/span&gt;/bin
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="使用技巧"&gt;使用技巧&lt;/h2&gt;
&lt;h3 id="goproxy"&gt;goproxy&lt;/h3&gt;
&lt;p&gt;使用goproxy加速&lt;code&gt;go module&lt;/code&gt;下载(解决&lt;code&gt;go get&lt;/code&gt;无法下载来自golang.org等站点的依赖包的问题）&lt;/p&gt;
&lt;p&gt;参考https://goproxy.io/zh/, 在go 1.13+下，我们可以使用以下命令在go env设置goproxy&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;go env -w &lt;span style="color:#033"&gt;GO111MODULE&lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;on
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;go env -w &lt;span style="color:#033"&gt;GOPROXY&lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;https://goproxy.io,direct
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# 设置不走 proxy 的私有仓库，多个用逗号相隔（可选）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;go env -w &lt;span style="color:#033"&gt;GOPRIVATE&lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;*.corp.example.com
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;同样推荐使用国内站点https://goproxy.cn/&lt;/p&gt;
&lt;h3 id="文档查看"&gt;文档查看&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;使用&lt;code&gt;go doc&lt;/code&gt;命令可以在终端快速查阅文档, 例如&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;go doc net.Listen | vim -
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="参考"&gt;参考&lt;/h2&gt;</description></item><item><title>Kubernetes使用入门</title><link>https://qtopie.github.io/notes/cloud-native/k8s/k8s-get-started/</link><pubDate>Sat, 04 Jan 2020 00:03:52 +0800</pubDate><guid>https://qtopie.github.io/notes/cloud-native/k8s/k8s-get-started/</guid><description>&lt;h2 id="容器化-containerization"&gt;容器化 Containerization&lt;/h2&gt;
&lt;p&gt;容器是标准化的软件单元。容器化将软件打包成标准化的单元，从而能够以此进行开发，装载和部署。简单地说，通过底层虚拟化，容器化实现应用Write once, run anywhere， 而且是快速地run anywhere，就像docker图标里被鲸鱼背着的集装箱一样。&lt;/p&gt;
&lt;h3 id="容器与虚拟机的对比"&gt;容器与虚拟机的对比&lt;/h3&gt;
&lt;p&gt;&lt;img src="https://www.docker.com/sites/default/files/d8/2018-11/docker-containerized-appliction-blue-border_2.png" alt="container"&gt;
&lt;img src="https://www.docker.com/sites/default/files/d8/2018-11/container-vm-whatcontainer_2.png" alt="vm"&gt;&lt;/p&gt;
&lt;p&gt;容器实现的是操作系统层面的虚拟化，而虚拟机是实现硬件层面的虚拟化。所以对于应用来说，选择容器会更加轻量级，这意味着它将占用更少的资源，能更快的启动和停止，更灵活地分配资源等等。&lt;/p&gt;
&lt;p&gt;PS: 这里并不是说容器一定总比虚拟机好，一般来说，不同的技术方案都有它适应的场景。比如我们需要模拟完整的硬件环境，虚拟机方案显然就更合适了。例如，在办公电脑上，我常常在windows笔记本上使用hyper-v安装一个ubuntu做开发，容器化方案在这里就相形见绌了。&lt;/p&gt;
&lt;p&gt;很多时候，容器和虚拟机被一起使用。比如，你买了一台性能很好的高可用服务器，1TB RAM, 64 core CPU，那么为了更合理的分配和管理资源，你可能首先在这台服务器上建立数个virtualbox虚拟机，然后再在虚拟机操作系统里安装docker。&lt;/p&gt;
&lt;h3 id="容器编排"&gt;容器编排&lt;/h3&gt;
&lt;p&gt;容器化是我们能更方便地打包和运行应用，但当需要运行成百上千或者更多容器的时候，容器的自动化管理就十分重要了。对于习惯于实现应用自动化的程序员来说，甚至只管理两三个容器就巴不得有一个工具来完成自动化。容器编排就是来解决这个问题的，比较流行的有Google开发并开源的kubernetes, 及docker官方推的docker swarm。前者几乎已经成为业界规范，不过docker swarm对docker集成的更好，如果熟悉docker的话，docker swarm也会更加容易上手。&lt;/p&gt;
&lt;p&gt;容器编排常见的功能 （不想翻译)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Expose containers by DNS name or IP address.&lt;/li&gt;
&lt;li&gt;Handle load balancing and traffic distribution for containers.&lt;/li&gt;
&lt;li&gt;Automatically mount local and cloud-based storage.&lt;/li&gt;
&lt;li&gt;Allocate specific CPU and RAM resources to containers and then fit them onto nodes.&lt;/li&gt;
&lt;li&gt;Replace or kill problematic containers without jeopardizing application performance and uptime.&lt;/li&gt;
&lt;li&gt;Manage sensitive information like password and tokens without rebuilding containers.&lt;/li&gt;
&lt;li&gt;Change the state of containers and roll back old containers to replace them with new ones.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="参考"&gt;参考&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.citrix.com/glossary/what-is-containerization.html"&gt;什么是容器化&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.ibm.com/cloud/blog/the-benefits-of-containerization-and-what-it-means-for-you"&gt;容器化的优点&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.docker.com/resources/what-container"&gt;什么是container&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="安装"&gt;安装&lt;/h2&gt;
&lt;h3 id="docker-安装"&gt;docker 安装&lt;/h3&gt;
&lt;p&gt;不推荐使用系统源或者snap包方式安装docker, 使用的时候会遇到环境或者兼容性的问题。&lt;/p&gt;</description></item><item><title>Make Eclipse Great Again</title><link>https://qtopie.github.io/notes/dev/make-gradle-work-with-eclipse/</link><pubDate>Sat, 28 Dec 2019 18:07:28 +0800</pubDate><guid>https://qtopie.github.io/notes/dev/make-gradle-work-with-eclipse/</guid><description>&lt;h1 id="eclipse--gradle"&gt;Eclipse &amp;amp; Gradle&lt;/h1&gt;
&lt;p&gt;还是从那句老话开始， “工欲善其事，必先利其器”。要想熟练地完成一件事，有个好的工具往往能事半功倍。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;但是很多时候，迷信教条最终会成了造轮子而造轮子的递归循环；选择合适的工具，并掌握它，解决好问题才是正确的方向。&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;这里简单说说，我选择Eclispe和Gradle的原因。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Gradle (Gradle VS Maven or Ant); 选择gradle的原因很简单，简单而清晰的语法，强大的脚本语言，快速而稳定的构建。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Eclipse (主要对比Idea, VS Code)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;开源及活跃而广受欢迎的社区&lt;/li&gt;
&lt;li&gt;相对于Idea来说，个人使用经验上来看，在大Project上使用（源码多，项目多）更稳定, 且有偏向支持开源社区的因素，故使用Eclipse；VS Code对于小的Project来说还好，功能比Eclipse弱，查看多个文件及源码也不是很方便，大项目会使系统卡顿，但是小项目一般可以使用gradle + vim。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="开发环境"&gt;开发环境&lt;/h2&gt;
&lt;p&gt;当前开发环境&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Ubuntu 19.10 x86_64&lt;/li&gt;
&lt;li&gt;Gradle 5.6.4&lt;/li&gt;
&lt;li&gt;Eclipse (Snap版本)&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;Eclipse Platform
Version: 2019-03 (4.11)
Build id: I20190307-0500
OS: Linux, v.5.3.0-24-generic, x86_64 / gtk 3.24.12
Java version: 1.8.0_171
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="eclipse项目配置及依赖管理"&gt;Eclipse项目配置及依赖管理&lt;/h2&gt;
&lt;h3 id="我的java项目管理方案"&gt;我的Java项目管理方案&lt;/h3&gt;
&lt;p&gt;我不喜欢将IDE文件提交到git代码仓库，在我看来，IDE的作用就是一个文本编辑器，而且从协作角度来看，不同的开发者可能会选择不同的编辑器，所以不需要将IDE文件提交。 而Gradle脚本，不仅作为项目开发中一款重要的工具，而且包含了很多项目配置信息，因此需要提交到git仓库(有时候，如果开发人员和CI使用了统一的或兼容的gradle版本，甚至gradle wrapper都不需要提交)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;生成项目配置&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;默认Gradle eclipse编译输出目录为bin, 但是gradle构建输出目录为build， 因此需要改配置。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-groovy" data-lang="groovy"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;plugins &lt;span style="color:#555"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; id &lt;span style="color:#c30"&gt;&amp;#39;java&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; id &lt;span style="color:#c30"&gt;&amp;#39;eclipse&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#555"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;eclipse &lt;span style="color:#555"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; project&lt;span style="color:#555"&gt;.&lt;/span&gt;&lt;span style="color:#309"&gt;natures&lt;/span&gt; &lt;span style="color:#c30"&gt;&amp;#39;org.eclipse.buildship.core.gradleprojectnature&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; classpath &lt;span style="color:#555"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; downloadJavadoc &lt;span style="color:#555"&gt;=&lt;/span&gt; &lt;span style="color:#069;font-weight:bold"&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; downloadSources &lt;span style="color:#555"&gt;=&lt;/span&gt; &lt;span style="color:#069;font-weight:bold"&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; defaultOutputDir &lt;span style="color:#555"&gt;=&lt;/span&gt; file&lt;span style="color:#555"&gt;(&lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#39;build/default&amp;#39;&lt;/span&gt;&lt;span style="color:#555"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; file&lt;span style="color:#555"&gt;.&lt;/span&gt;&lt;span style="color:#309"&gt;whenMerged&lt;/span&gt; &lt;span style="color:#555"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; entries&lt;span style="color:#555"&gt;.&lt;/span&gt;&lt;span style="color:#309"&gt;each&lt;/span&gt; &lt;span style="color:#555"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; source &lt;span style="color:#555"&gt;-&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#09f;font-style:italic"&gt;// This seems kludgy. If the second test is omitted, it fails processing a &amp;#39;Project Dependency&amp;#39; entry
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;&lt;/span&gt; &lt;span style="color:#069;font-weight:bold"&gt;if&lt;/span&gt; &lt;span style="color:#555"&gt;(&lt;/span&gt;source&lt;span style="color:#555"&gt;.&lt;/span&gt;&lt;span style="color:#309"&gt;kind&lt;/span&gt; &lt;span style="color:#555"&gt;==&lt;/span&gt; &lt;span style="color:#c30"&gt;&amp;#39;src&amp;#39;&lt;/span&gt; &lt;span style="color:#555"&gt;&amp;amp;&amp;amp;&lt;/span&gt; source&lt;span style="color:#555"&gt;.&lt;/span&gt;&lt;span style="color:#309"&gt;hasProperty&lt;/span&gt;&lt;span style="color:#555"&gt;(&lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#39;output&amp;#39;&lt;/span&gt;&lt;span style="color:#555"&gt;))&lt;/span&gt; &lt;span style="color:#555"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#078;font-weight:bold"&gt;def&lt;/span&gt; outputPath &lt;span style="color:#555"&gt;=&lt;/span&gt; source&lt;span style="color:#555"&gt;.&lt;/span&gt;&lt;span style="color:#309"&gt;output&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#069;font-weight:bold"&gt;switch&lt;/span&gt;&lt;span style="color:#555"&gt;(&lt;/span&gt;source&lt;span style="color:#555"&gt;.&lt;/span&gt;&lt;span style="color:#309"&gt;path&lt;/span&gt;&lt;span style="color:#555"&gt;)&lt;/span&gt; &lt;span style="color:#555"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#069;font-weight:bold"&gt;case&lt;/span&gt; &lt;span style="color:#c30"&gt;&amp;#39;src/main/java&amp;#39;&lt;/span&gt;&lt;span style="color:#555"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; source&lt;span style="color:#555"&gt;.&lt;/span&gt;&lt;span style="color:#309"&gt;output&lt;/span&gt; &lt;span style="color:#555"&gt;=&lt;/span&gt; &lt;span style="color:#c30"&gt;&amp;#39;build/classes/java/main&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#069;font-weight:bold"&gt;break&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#069;font-weight:bold"&gt;case&lt;/span&gt; &lt;span style="color:#c30"&gt;&amp;#39;src/main/resources&amp;#39;&lt;/span&gt;&lt;span style="color:#555"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; source&lt;span style="color:#555"&gt;.&lt;/span&gt;&lt;span style="color:#309"&gt;output&lt;/span&gt; &lt;span style="color:#555"&gt;=&lt;/span&gt; &lt;span style="color:#c30"&gt;&amp;#39;build/resources/main&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#069;font-weight:bold"&gt;break&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#069;font-weight:bold"&gt;case&lt;/span&gt; &lt;span style="color:#c30"&gt;&amp;#39;src/test/java&amp;#39;&lt;/span&gt;&lt;span style="color:#555"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; source&lt;span style="color:#555"&gt;.&lt;/span&gt;&lt;span style="color:#309"&gt;output&lt;/span&gt; &lt;span style="color:#555"&gt;=&lt;/span&gt; &lt;span style="color:#c30"&gt;&amp;#39;build/classes/java/test&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#069;font-weight:bold"&gt;break&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#069;font-weight:bold"&gt;case&lt;/span&gt; &lt;span style="color:#c30"&gt;&amp;#39;src/test/resources&amp;#39;&lt;/span&gt;&lt;span style="color:#555"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; source&lt;span style="color:#555"&gt;.&lt;/span&gt;&lt;span style="color:#309"&gt;output&lt;/span&gt; &lt;span style="color:#555"&gt;=&lt;/span&gt; &lt;span style="color:#c30"&gt;&amp;#39;build/resources/test&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#069;font-weight:bold"&gt;break&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#555"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#555"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#555"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#555"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#555"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#555"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;a href="https://github.com/gradle/gradle/issues/3839"&gt;https://github.com/gradle/gradle/issues/3839&lt;/a&gt;&lt;/p&gt;</description></item><item><title>vocore2播放音频-使用路由器听歌？</title><link>https://qtopie.github.io/notes/iot/vocore/vocore-network-audio/</link><pubDate>Fri, 26 Jul 2019 22:24:33 +0800</pubDate><guid>https://qtopie.github.io/notes/iot/vocore/vocore-network-audio/</guid><description>&lt;h2 id="目标"&gt;目标&lt;/h2&gt;
&lt;p&gt;构建一个可编程控制的流媒体播放服务器，类似于智能音箱，但是没有麦克风收集个人隐私数据。&lt;/p&gt;
&lt;p&gt;整体架构如下&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-mermaid" data-lang="mermaid"&gt;graph LR
 subgraph 树莓派 Raspberry Pi
 A[cmus音乐播放器] --&amp;gt; B(PulseAudio Client)
 end

 subgraph VoCore
 C(PulseAudio Server) --&amp;gt; D[音响 / 扬声器]
 end

 B --&amp;gt; C
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="vocore固件支持"&gt;Vocore固件支持&lt;/h2&gt;
&lt;p&gt;Currently 2022/12/3, only openwrt 21.02 is supported. (patch is not working ins 22.03)&lt;/p&gt;
&lt;p&gt;see &lt;a href="https://github.com/Vonger/vocore2"&gt;https://github.com/Vonger/vocore2&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Because audio is enabled by &lt;em&gt;kmod+&lt;/em&gt; packages, so I need to build the firmware myself.&lt;/p&gt;
&lt;h2 id="alsa"&gt;Alsa&lt;/h2&gt;
&lt;p&gt;install &lt;code&gt;alsa-utils&lt;/code&gt; packages, then add configuration to init sound card&lt;/p&gt;
&lt;p&gt;in &lt;code&gt;/etc/rc.local&lt;/code&gt; file&lt;/p&gt;</description></item><item><title>Ubuntu下使用MT7612U</title><link>https://qtopie.github.io/notes/linux/mt7612u-driver/</link><pubDate>Sat, 09 Mar 2019 11:29:38 +0800</pubDate><guid>https://qtopie.github.io/notes/linux/mt7612u-driver/</guid><description>&lt;p&gt;由于墙挡住了路由器WIFI信号，虽然5G频率的WIFI传输速率很快，但是信号衰减。WIFI无线通信是双方向的，就算路由信号能覆盖到，但考虑到手机或笔记本功率和天线的限制，难保证信号稳定。所以在淘宝上买了一个功能还算强大的无线网卡ComFast 926AC v2，双频WIFI外置双天线。没提前研究，“号称免驱动&amp;quot;，结果拿回来就懵了。&lt;/p&gt;
&lt;h2 id="安装驱动"&gt;安装驱动&lt;/h2&gt;
&lt;p&gt;设备: Comfast 926AC v2
系统： Ubuntu 18.04&lt;/p&gt;
&lt;p&gt;因为是联发科的芯片，通常都是在同一份驱动代码上改改完成的。故从github上寻找了下面两个仓库的代码。&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/ulli-kroll/mt7612u"&gt;ulli-kroll/mt7612u&lt;/a&gt;, &lt;a href="https://github.com/jurobystricky/Netgear-A6210"&gt;jurobystricky/Netgear-A6210&lt;/a&gt;
&lt;a href="https://www.mediatek.com/products/broadbandWifi/mt7612u"&gt;官方驱动&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;上面两驱动实际是在官方源码上改写的，但编译后，三个都不能正常工作。&lt;/p&gt;
&lt;p&gt;后来在&lt;code&gt;openwrt/linux&lt;/code&gt;项目下发现该设备驱动的相关issue, 并已有大牛正在mt76驱动项目下加入该芯片的支持。故转用mt76的设备。查询linux主仓库代码发现，该驱动已随Linux内核5.0发布。因此直接下载linux 5.0内核包安装就行了。&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; # 5.0: https://kernel.ubuntu.com/~kernel-ppa/mainline/v5.0/
 linux-headers-5.0.0-050000_5.0.0-050000.201903032031_all.deb
 linux-headers-5.0.0-050000-generic_5.0.0-050000.201903032031_amd64.deb
 linux-image-unsigned-5.0.0-050000-generic_5.0.0-050000.201903032031_amd64.deb
 linux-modules-5.0.0-050000-generic_5.0.0-050000.201903032031_amd64.deb
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;手动升级内核后测试能使用, 并支持AP：&lt;/p&gt;
&lt;p&gt;iwconfig&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;wlx40a5eff2b655 IEEE 802.11 ESSID:off/any 
 Mode:Managed Access Point: Not-Associated Tx-Power=19 dBm 
 Retry short limit:7 RTS thr:off Fragment thr:off
 Power Management:off
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;网卡识别为存储设备的问题&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;mt76还未对这款comfast网卡适配，所以默认会被系统识别为存储设备，可以手动切换过来：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo usb_modeswitch -KW -v 0e8d -p &lt;span style="color:#f60"&gt;2870&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;或者修改&lt;code&gt;/lib/udev/rules.d/40-usb_modeswitch.rules&lt;/code&gt;文件自动切换（目前未成功）&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;# MT7612U 
ATTR{idVendor}==&amp;#34;0e8d&amp;#34;, ATTR{idProduct}==&amp;#34;2870&amp;#34;, RUN+=&amp;#34;usb_modeswitch &amp;#39;%b/%k&amp;#39;&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;USB底座接触不良的问题&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;一起买的底座有点问题，开始还以为也要装什么驱动。检查后发现是接触不良的问题，因为USB口没有固定住，所以网卡很容易没有插入到底座中。解决办法比较简单，拆卸底座，然后填充底座中空部分，固定住USB接口。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;其他适配问题&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;网卡的LED灯不能正常工作。&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;pi@raspberrypi:~ $ sudo ifconfig wlan1 down
pi@raspberrypi:~ $ sudo ifconfig wlan1 hw ether 00:28:C7:0A:42:A2
pi@raspberrypi:~ $ sudo ifconfig wlan1 up
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="尝试在树梅派上编译驱动"&gt;尝试在树梅派上编译驱动&lt;/h2&gt;
&lt;p&gt;&lt;del&gt;4.19.y已经加入mt7612u的支持，但是经过测试，并不能使用。&lt;/del&gt;[更新] 在5.1.y上编译可以正常使用（STA模式）, 注意默认缺失了&lt;code&gt;/lib/firmware/mt7662.bin /lib/firmware/mt7662_rom_patch.bin&lt;/code&gt; 两个文件，可以从其它系统拷贝或网络下载到树梅派。&lt;/p&gt;</description></item><item><title>Drone CI With Github</title><link>https://qtopie.github.io/notes/cloud-native/cicd/drone-ci-with-github/</link><pubDate>Tue, 05 Mar 2019 23:58:06 +0800</pubDate><guid>https://qtopie.github.io/notes/cloud-native/cicd/drone-ci-with-github/</guid><description>&lt;p&gt;Yeah, another CI tool. That&amp;rsquo;s named &lt;a href="https://drone.io/"&gt;&lt;code&gt;Drone&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;We&amp;rsquo;ve been heard of Jenkins, travis-ci and even circle-ci (I have to mention this because there&amp;rsquo;re too much ads on youtube for it), so why would we need another one?&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;ve used Jenkins and travis-ci, but they are not perfect, at least there are some slight drawbacks.&lt;/p&gt;
&lt;h2 id="my-experience-on-jenkins"&gt;My experience on Jenkins&lt;/h2&gt;
&lt;p&gt;Jenkins is stable for production, it has long history and is used widely. But sometimes I find Jenkins is too slow, and configuration is not straightforward. And it&amp;rsquo;s a pain to upgrade to a new pipeline, you have to copy and paste jobs from UI (while accessing is pretty slow). You might able to config jobs with XML config files, but it&amp;rsquo;s still a bit of complicated.&lt;/p&gt;</description></item><item><title>Jiri</title><link>https://qtopie.github.io/notes/cloud-native/cicd/jiri.zh/</link><pubDate>Thu, 20 Dec 2018 17:23:02 +0800</pubDate><guid>https://qtopie.github.io/notes/cloud-native/cicd/jiri.zh/</guid><description>&lt;p&gt;Jiri (/jɪəri/ YEER-ee)是谷歌工程师开发的，灵活集成多个git仓库的工具，主要用来管理fuchsia操作系统源码。&lt;/p&gt;
&lt;p&gt;其主要功能类似于&lt;code&gt;git submodule&lt;/code&gt;, 但使用方式更加灵活，不需要对原git仓库的行为做任何修改，也可以不用在主仓库不断更新引用。&lt;/p&gt;
&lt;h2 id="安装"&gt;安装&lt;/h2&gt;
&lt;p&gt;推荐从源码编译安装 (需要安装最新版本Go语言构建工具）&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;git clone https://fuchsia.googlesource.com/jiri
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#366"&gt;cd&lt;/span&gt; jiri/cmd/jiri/jiri 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;go build
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# go install&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo mv jiri /usr/local/bin/jiri
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="manifest"&gt;Manifest&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;manifest (文件名称为foo)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-xml" data-lang="xml"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#099"&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#309;font-weight:bold"&gt;&amp;lt;manifest&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#309;font-weight:bold"&gt;&amp;lt;projects&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#309;font-weight:bold"&gt;&amp;lt;project&lt;/span&gt; &lt;span style="color:#309"&gt;name=&lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;spring-petclinic-mybatis&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#309"&gt;remote=&lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;https://github.com/artificerpi/spring-petclinic-mybatis&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#309"&gt;path=&lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;backend&amp;#34;&lt;/span&gt;&lt;span style="color:#309;font-weight:bold"&gt;/&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#309;font-weight:bold"&gt;&amp;lt;project&lt;/span&gt; &lt;span style="color:#309"&gt;name=&lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;spring-petclinic-angular&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#309"&gt;remote=&lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;https://github.com/spring-petclinic/spring-petclinic-angular.git&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#309"&gt;path=&lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;frontend&amp;#34;&lt;/span&gt;&lt;span style="color:#309;font-weight:bold"&gt;/&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#309;font-weight:bold"&gt;&amp;lt;/projects&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#309;font-weight:bold"&gt;&amp;lt;/manifest&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;将此文件放到git仓库根目录下，本地创建目录foo&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;mkdir foo &lt;span style="color:#555"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style="color:#366"&gt;cd&lt;/span&gt; foo
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;jiri init
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# manifest repos&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;jiri import foo https://github.com/artificerpi/jiri-foo
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;jiri update
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;更多使用参考下面的文档和help命令&lt;/p&gt;
&lt;h2 id="参考"&gt;参考&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://fuchsia.googlesource.com/jiri/"&gt;https://fuchsia.googlesource.com/jiri/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>树莓派4G模块</title><link>https://qtopie.github.io/notes/iot/rpi/rpi-4g-lte-module/</link><pubDate>Wed, 05 Dec 2018 22:36:06 +0800</pubDate><guid>https://qtopie.github.io/notes/iot/rpi/rpi-4g-lte-module/</guid><description>&lt;h2 id="准备环境"&gt;准备环境&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;树莓派3B&lt;/li&gt;
&lt;li&gt;华为4G模块：HUAWEI ME909s-821&lt;/li&gt;
&lt;li&gt;PCIE转USB开发板&lt;/li&gt;
&lt;li&gt;5cm天线转接线，SMA公头外螺内孔&lt;/li&gt;
&lt;li&gt;吸盘天线全向高增益天线，SMA公头外螺内孔&lt;/li&gt;
&lt;li&gt;中国移动4G SIM卡&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="4g模块技术规格及文档"&gt;4G模块技术规格及文档&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;技术规格 &lt;a href="http://consumer.huawei.com/solutions/m2m-solutions/en/products/tech-specs/me909s_821_en.htm"&gt;连接&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;基于海思芯片, 同类比较 SIM7600CE (Qualcomm MDM9206)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;文档 &lt;a href="http://download-c1.huawei.com/download/downloadCenter?downloadId=60305&amp;amp;version=200311&amp;amp;siteCode=worldwide&amp;amp;view=true"&gt;连接&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;主天线M口&lt;/p&gt;
&lt;h2 id="开始使用"&gt;开始使用&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;Windows上使用该4G模块需要手动安装驱动，驱动&lt;a href="https://techship.com/downloads/category/software-software-huawei-me909s-821-lga/"&gt;连接&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Ubuntu下可以使用&lt;code&gt;modemmanager&lt;/code&gt;管理4G模块&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;树莓派下使用教程如下。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;查看usb设备是否被识别&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;lsusb
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# output:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Bus &lt;span style="color:#f60"&gt;001&lt;/span&gt; Device 004: ID 12d1:15c1 Huawei Technologies Co., Ltd. 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Bus &lt;span style="color:#f60"&gt;001&lt;/span&gt; Device 003: ID 0424:ec00 Standard Microsystems Corp. SMSC9512/9514 Fast Ethernet Adapter
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Bus &lt;span style="color:#f60"&gt;001&lt;/span&gt; Device 002: ID 0424:9514 Standard Microsystems Corp. SMC9514 Hub
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Bus &lt;span style="color:#f60"&gt;001&lt;/span&gt; Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;安装拨号软件&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo apt-get update
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo apt-get install ppp usb-modeswitch wvdial
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;初始化wvdial配置&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo wvdialconf /etc/wvdial.conf
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;修改&lt;code&gt;wvdial&lt;/code&gt;配置&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;[Dialer Defaults]
Init1 = ATZ
Init2 = ATQ0 V1 E1 S0=0
Init3 = AT+CGDCONT=1,&amp;#34;IP&amp;#34;, &amp;#34;cmnet&amp;#34;
Modem Type = Analog Modem
Baud = 9600
New PPPD = yes
Modem = /dev/ttyUSB0
ISDN = 0
Phone = *99***1#
Password = { }
Username = { }
Auto DNS = on
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;APN和拨号设置参考&lt;/p&gt;</description></item><item><title>Vbox Ubuntu Server</title><link>https://qtopie.github.io/notes/linux/vbox-ubuntu-server/</link><pubDate>Tue, 27 Nov 2018 22:32:33 +0800</pubDate><guid>https://qtopie.github.io/notes/linux/vbox-ubuntu-server/</guid><description>&lt;h1 id="virtualbox-with-ubuntu-server"&gt;Virtualbox with Ubuntu Server&lt;/h1&gt;
&lt;p&gt;&lt;em&gt;Manage Virtualbox in command line&lt;/em&gt;&lt;/p&gt;
&lt;h2 id="installation"&gt;Installation&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo apt install virtualbox
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# or manually&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# wget https://download.virtualbox.org/virtualbox/5.2.22/virtualbox-5.2_5.2.22-126460~Ubuntu~bionic_amd64.deb&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# sudo dpkg -i virtualbox*.deb&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="install-extenstion-pack"&gt;Install extenstion pack&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo apt install virtualbox-ext-pack 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# or manually&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# sudo VBoxManage extpack install Oracle_VM_VirtualBox_Extension_Pack-5.2.4-119785.vbox-extpack&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# check installation&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;VBoxManage list extpacks
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="create-vm"&gt;Create VM&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Create virtual disk&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;VBoxManage createmedium disk --filename ubuntu-server1.vdi --size &lt;span style="color:#f60"&gt;8192&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Create virtual machine&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;VBoxManage list ostypes | grep -B &lt;span style="color:#f60"&gt;1&lt;/span&gt; -A &lt;span style="color:#f60"&gt;2&lt;/span&gt; Ubuntu
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;VBoxManage createvm --name ubuntu-server1 --ostype &lt;span style="color:#c30"&gt;&amp;#34;Ubuntu_64&amp;#34;&lt;/span&gt; --register
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Configure virtual machine&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# add sata disk&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;VBoxManage storagectl ubuntu-server1 --name SATA --add sata --controller IntelAHCI
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;VBoxManage storageattach ubuntu-server1 --storagectl SATA --port &lt;span style="color:#f60"&gt;0&lt;/span&gt; --device &lt;span style="color:#f60"&gt;0&lt;/span&gt; --type hdd --medium ubuntu-server1.vdi
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# mount dvd bootable iso file&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;VBoxManage storagectl ubuntu-server1 --name IDE --add ide
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;VBoxManage storageattach ubuntu-server1 --storagectl IDE --port &lt;span style="color:#f60"&gt;0&lt;/span&gt; --device &lt;span style="color:#f60"&gt;0&lt;/span&gt; --type dvddrive --medium ~/Downloads/mini.iso
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;VBoxManage modifyvm ubuntu-server1 --ioapic on
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;VBoxManage modifyvm ubuntu-server1 --boot1 dvd --boot2 disk --boot3 none --boot4 none
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;VBoxManage modifyvm ubuntu-server1 --memory &lt;span style="color:#f60"&gt;512&lt;/span&gt; --vram &lt;span style="color:#f60"&gt;8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;VBoxManage modifyvm ubuntu-server1 --nic1 nat
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Set for VRDE (optional)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;VBoxManage setproperty vrdeextpack &lt;span style="color:#c30"&gt;&amp;#34;Oracle VM VirtualBox Extension Pack&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# vrde port 5000, 5010, 5011 or 5012&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;VBoxManage modifyvm ubuntu-server1 --vrde on --vrdeport 5000,5010-5012 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Start vm&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;VBoxManage startvm ubuntu-server1 --type headless
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;VBoxManage showvminfo ubuntu-server1
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Test it &lt;code&gt;rdesktop -a 16 -N &amp;lt;HOST-IP&amp;gt;:&amp;lt;PORT&amp;gt;&lt;/code&gt;&lt;/p&gt;</description></item><item><title>我的DIY与vocore</title><link>https://qtopie.github.io/notes/iot/vocore/my-vocore-playground/</link><pubDate>Thu, 26 Jul 2018 22:24:33 +0800</pubDate><guid>https://qtopie.github.io/notes/iot/vocore/my-vocore-playground/</guid><description>&lt;h2 id="vocore"&gt;&lt;a href="http://vocore.io/"&gt;VoCore&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;硬币大小的Linux计算机（或者可以DIY的mini路由器）&lt;/p&gt;
&lt;h2 id="技术参数"&gt;技术参数&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Target: &lt;a href="https://openwrt.org/docs/techref/targets/ramips"&gt;ramips&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Subtarget: &lt;code&gt;mt7628&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Package architecture: &lt;code&gt;mipsel_24kc&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://openwrt.org/toh/hwdata/vocore/vocore_vocore2"&gt;OpenWRT techdata&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;具体参数请看官网介绍 &lt;a href="http://vocore.io/v2u.html"&gt;VoCore2 Ultimate&lt;/a&gt; 和 &lt;a href="https://openwrt.org/toh/hwdata/vocore/vocore_vocore2"&gt;openwrt列出的技术数据&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="openwrt介绍"&gt;OpenWRT介绍&lt;/h2&gt;
&lt;p&gt;OpenWRT(与&lt;a href="https://zh.wikipedia.org/wiki/LEDE"&gt;LEDE&lt;/a&gt;合并后更名为OpenWrt)是一个适用于嵌入式设备的Linux发行版，最初&lt;a href="https://zh.wikipedia.org/wiki/OpenWrt"&gt;由Linksys公司推出的WRT-54G无线路由中使用的Linux系统开源而来&lt;/a&gt;。相比于路由器原厂固件而言，OpenWRT提供了一个可添加软件包的可写文件系统，这样用户就能自己定制路由器的功能。基于开放的生态和良好的技术社区环境，OpenWRT十分适合喜好DIY的科技粉来定制自己的路由器。&lt;/p&gt;
&lt;p&gt;OpenWRT主要使用opkg来管理软件包，默认使用LuCI作为web交互界面。下面简单列出它们的常用方式，具体使用方法请查阅文档。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;opkg&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-sh" data-lang="sh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# 安装软件包&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;opkg install &amp;lt;PACKAGE-NAME&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# 卸载软件包&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;opkg remove &amp;lt;PACKAGE-NAME&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;uci&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-sh" data-lang="sh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# 设置option&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;uci &lt;span style="color:#366"&gt;set&lt;/span&gt; &amp;lt;OPTION&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# 查看option&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;uci show &amp;lt;OPTION&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="我的定制"&gt;我的定制&lt;/h2&gt;
&lt;h3 id="基本设置"&gt;基本设置&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Change SSID Name&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-sh" data-lang="sh"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;uci &lt;span style="color:#366"&gt;set&lt;/span&gt; wireless.ap.ssid&lt;span style="color:#555"&gt;=&lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#39;firefly&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;uci commit 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# check result&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;uci show wireless.ap.ssid
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# restart networking service to make reload configuration&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/etc/init.d/network restart
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# check network in another machine&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo iw dev wlan0 scan | grep SSID
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="wget-ssl"&gt;wget ssl&lt;/h2&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;opkg install libustream-openssl ca-bundle ca-certificates
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="apsta模式-或者叫无线中继器"&gt;AP+STA模式 （或者叫无线中继器）&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;使用固件 &lt;a href="http://vonger.cn/misc/vocore2/20180723V.bin"&gt;vocore2-20180723V&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;配置信息(仅供参考)：&lt;/p&gt;</description></item><item><title>My notes on Raspberry Pi</title><link>https://qtopie.github.io/notes/iot/rpi/setup-my-raspberrypi/</link><pubDate>Sun, 29 Oct 2017 16:40:22 +0800</pubDate><guid>https://qtopie.github.io/notes/iot/rpi/setup-my-raspberrypi/</guid><description>&lt;h2 id="headless-setup-no-external-monitor-or-keyboard"&gt;Headless setup (no external monitor or keyboard)&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Updated: according to the &lt;a href="https://www.raspberrypi.com/documentation/computers/getting-started.html#configuration-on-first-boot"&gt;Raspibian Documentation&lt;/a&gt;,
use Raspberry Pi Imagger is strongly recommended&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id="networking"&gt;Networking&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Auto connect to wifi&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;create an &lt;code&gt;wpa_supplicant.conf&lt;/code&gt; file in boot partition&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-conf" data-lang="conf"&gt;country=us
update_config=1
ctrl_interface=/var/run/wpa_supplicant

network={
 scan_ssid=1
 ssid=&amp;#34;Your-SSID&amp;#34;
 psk=&amp;#34;replace-with-your-password&amp;#34;
 priority=100
}
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;Connect to WIFI with CLI&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Refer to &lt;a href="https://www.raspberrypi.org/documentation/configuration/wireless/wireless-cli.md"&gt;https://www.raspberrypi.org/documentation/configuration/wireless/wireless-cli.md&lt;/a&gt;&lt;/p&gt;
&lt;h3 id="enable-ssh"&gt;Enable SSH&lt;/h3&gt;
&lt;p&gt;Simply create an empty &lt;code&gt;ssh&lt;/code&gt; file in the root directory of boot partition.&lt;/p&gt;
&lt;p&gt;Refer to &lt;a href="https://www.raspberrypi.org/documentation/remote-access/ssh/"&gt;https://www.raspberrypi.org/documentation/remote-access/ssh/&lt;/a&gt;&lt;/p&gt;
&lt;h3 id="get-ip-of-your-pi"&gt;Get IP of your pi&lt;/h3&gt;
&lt;h4 id="with-computer"&gt;With Computer&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo nmap -sP 192.168.21.*
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# results &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;MAC Address: B8:27:EB:40:A9:D7 &lt;span style="color:#555"&gt;(&lt;/span&gt;Raspberry Pi Foundation&lt;span style="color:#555"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Nmap scan report &lt;span style="color:#069;font-weight:bold"&gt;for&lt;/span&gt; 192.168.31.158
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="with-android-phone"&gt;With Android Phone&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Install connectBot or other terminal app&lt;/li&gt;
&lt;li&gt;Share the network of your android device with usb network;&lt;/li&gt;
&lt;li&gt;Enter local mode, use &lt;code&gt;ip neighbor&lt;/code&gt; command to get the ip address of your raspberrypi&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now you can ssh to your raspberry pi with this ip.&lt;/p&gt;</description></item><item><title>Git快速手册</title><link>https://qtopie.github.io/notes/dev/git-quick-guide/</link><pubDate>Wed, 05 Jul 2017 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/dev/git-quick-guide/</guid><description>&lt;p&gt;&lt;strong&gt;WIP&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id="快速开始"&gt;快速开始&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;设置个人信息&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;git config --global user.name &amp;lt;YOUR-NAME&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;git config --global user.email &amp;lt;YOUR-EMAIL&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# 查看个人配置&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;git config --list
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;将默认主仓库设置为&lt;code&gt;main&lt;/code&gt; &lt;a href="https://github.com/github/renaming"&gt;BLM运动&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;git config --global init.defaultbranch main
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;初始化仓库&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;mkdir /path/to/your/project
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#366"&gt;cd&lt;/span&gt; /path/to/your/project
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;git init 			&lt;span style="color:#09f;font-style:italic"&gt;# initialize an empty git repo&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;git remote add origin git@repo-url.git
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="create-your-first-file-and-push-it-to-the-remote-repo"&gt;Create your first file and push it to the remote repo&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#366"&gt;echo&lt;/span&gt; &lt;span style="color:#c30"&gt;&amp;#34;qtopie.rw&amp;#34;&lt;/span&gt; &amp;gt;&amp;gt; contributors.txt
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;git add contributors.txt
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;git commit -m &lt;span style="color:#c30"&gt;&amp;#39;Initial commit with contributors&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;git push -u origin master
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;总结下常用操作&lt;/p&gt;</description></item><item><title>Dockerfile</title><link>https://qtopie.github.io/notes/cloud-native/cicd/dockerfile/</link><pubDate>Wed, 02 Nov 2016 15:52:30 +0800</pubDate><guid>https://qtopie.github.io/notes/cloud-native/cicd/dockerfile/</guid><description>&lt;h2 id="introduction"&gt;Introduction&lt;/h2&gt;
&lt;p&gt;Docker, an opensource container management tool based on LXC(Linux container).&lt;/p&gt;
&lt;!-- ## Write Dockerfile

### A simple example with NGINX
```dockerfile
# Nginx
#
# VERSION 0.0.1

FROM ubuntu
MAINTAINER Victor Vieux &lt;victor@docker.com&gt;

LABEL Description="This image is used to start the foobar executable" Vendor="ACME Products" Version="1.0"
RUN apt-get update &amp;&amp; apt-get install -y inotify-tools nginx apache2 openssh-server
```
you can build by run: `docker build .`

## Tips
- Sometimes when you are using ubuntu as the base image, running `apt-get` may
	takes lots of time, usually it's because the official mirror is slow to
	reach.
	You can change to a source by following command:

``` Dockerfile
RUN sed -i 's/http:\/\/archive&gt;ubuntu&gt;com\/ubuntu\//http:\/\/mirrors&gt;163&gt;com\/ubuntu\//g' /etc/apt/sources.list
```

## Simple Tutorial for starting with docker
- Pull an image from docker repo:

``` bash
docker pull ubuntu 		# pull `ubuntu` image from official repo: dockerhub
```

- Instantiate to a docker container

``` bash
docker run ubuntu

# or specify a container name 
docker run --name my-container ubuntu
```

- Attach it to enter the container

``` bash
docker exec -it my-container /bin/bash
```


## Reference 
https://docs.docker.com/engine/reference/builder/ --&gt;</description></item><item><title>Regular Expression</title><link>https://qtopie.github.io/notes/web/regex/</link><pubDate>Tue, 25 Oct 2016 00:35:03 +0800</pubDate><guid>https://qtopie.github.io/notes/web/regex/</guid><description>&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;username:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;^[a-z0-9_-]{3,16}$&lt;/code&gt; // any character of a-z, 0-9, underscore and &amp;lsquo;-&amp;rsquo;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;password:&lt;/p&gt;
&lt;p&gt;similar to username&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;email:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;^([a-z0-9_\.-]+)@([a-z0-9_\.-]+)\.([a-z\.]{2,6})$&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;url:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;^(https?:\/\/)?(\da-z\.-]+)\.([a-z\.]{2,6})([/\w\.-]*)*\/?$&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;not&lt;/p&gt;
&lt;p&gt;[^]&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;abc…	Letters
123…	Digits
\d	Any Digit
\D	Any Non-digit character
.	Any Character
\.	Period
[abc]	Only a, b, or c
[^abc]	Not a, b, nor c
[a-z]	Characters a to z
[0-9]	Numbers 0 to 9
\w	Any Alphanumeric character
\W	Any Non-alphanumeric character
{m}	m Repetitions
{m,n}	m to n Repetitions

-	Zero or more repetitions
+	One or more repetitions
?	Optional character
\s	Any Whitespace
\S	Any Non-whitespace character
^…$	Starts and ends
(…)	Capture Group
(a(bc))	Capture Sub-group
(.*)	Capture all
(abc|def)	Matches abc or def
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;To help you better understand the regular expressions, &lt;a href="https://regexper.com"&gt;Visualized with
Regexper&lt;/a&gt;&lt;/p&gt;</description></item><item><title>Ubuntu init process</title><link>https://qtopie.github.io/notes/linux/systemd-service-unit-file/</link><pubDate>Thu, 15 Sep 2016 14:20:15 +0800</pubDate><guid>https://qtopie.github.io/notes/linux/systemd-service-unit-file/</guid><description>&lt;h2 id="history"&gt;History&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;sysVinit&lt;/li&gt;
&lt;li&gt;&lt;a href="http://upstart.ubuntu.com/"&gt;upstart&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;systemd&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ubuntu: sysVinit &amp;ndash;&amp;gt; upstart(6.10+) &amp;ndash;&amp;gt; systemd (15.04+)&lt;/p&gt;
&lt;h3 id="features-of-upstart"&gt;Features of Upstart&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;Event Based&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Start System faster (compare with previous method).&lt;/li&gt;
&lt;li&gt;Dynamically start service when discovering new device&lt;/li&gt;
&lt;li&gt;Dynamically stop service when device is removed&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="systemd"&gt;Systemd&lt;/h2&gt;
&lt;p&gt;Systemd is a collection of system management daemons, utilities and libraries which serves as a replacement of System V init daemon. Systemd functions as
central management and configuration platform for UNIX like system.&lt;/p&gt;</description></item><item><title>Wifi with hostapd</title><link>https://qtopie.github.io/notes/linux/hostapd-wifi/</link><pubDate>Tue, 30 Aug 2016 19:06:18 +0800</pubDate><guid>https://qtopie.github.io/notes/linux/hostapd-wifi/</guid><description>&lt;h2 id="hostapd"&gt;&lt;a href="https://w1.fi/hostapd/"&gt;Hostapd&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;hostapd is a user space daemon for access point and authentication server.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Please follow the guide of &lt;a href="https://www.raspberrypi.org/documentation/configuration/wireless/access-point.md"&gt;Official documentation&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id="installation-and-configuration"&gt;Installation and configuration&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;Tested on raspbian with raspberry pi 3&lt;/em&gt;&lt;/p&gt;
&lt;h3 id="install-hostapd-and-configure-it"&gt;Install hostapd and configure it&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;sudo apt-get install hostapd -y --force-yes&lt;/code&gt;,
also &lt;code&gt;sudo apt-get install haveged&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Edit &lt;code&gt;hostapd.conf&lt;/code&gt;:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;&lt;code&gt;/etc/hostapd/hostapd.conf&lt;/code&gt;&lt;/em&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;interface=wlan0
ssid=RPi
wpa_passphrase=raspberrypi
auth_algs=1
wpa=2
wpa_key_mgmt=WPA-PSK
rsn_pairwise=CCMP
channel=10
hw_mode=g
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;There should not be any whitespace at the end of each line&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;then modify file &lt;code&gt;/etc/default/hostapd&lt;/code&gt; to let the configuration work
automatically.&lt;/p&gt;</description></item><item><title>开始使用Ubuntu</title><link>https://qtopie.github.io/notes/linux/getting-started-with-ubuntu/</link><pubDate>Mon, 17 Nov 2014 22:24:33 +0800</pubDate><guid>https://qtopie.github.io/notes/linux/getting-started-with-ubuntu/</guid><description>&lt;h2 id="介绍"&gt;介绍&lt;/h2&gt;
&lt;p&gt;Ubuntu是一个以桌面应用为主的Linux操作系统，基于Debian发行版和GNOME桌面环境(17.10又回到gnome)，与Debian的不同在于它每6个月会发布一个新版本。Ubuntu的目标在于为一般用户提供一个最新的、同时又相当稳定的主要由自由软件构建而成的操作系统。Ubuntu具有庞大的社区力量（如&lt;a href="https://askubuntu.com/"&gt;askubuntu&lt;/a&gt;)，用户可以方便地从社区获得帮助。对于我个人而言，最吸引的是Ubuntu的开放性及活跃的社区,在Ubuntu上做开发也更加得心应手。&lt;/p&gt;
&lt;h2 id="系统安装"&gt;系统安装&lt;/h2&gt;
&lt;p&gt;以Ubuntu桌面版(amd64)为例&lt;/p&gt;
&lt;h3 id="预先准备"&gt;预先准备&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://cn.ubuntu.com/download/desktop"&gt;ISO文件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;可格式化的U盘 (建议4G以上)&lt;/li&gt;
&lt;li&gt;启动盘创建工具&lt;a href="https://rufus.ie/zh/"&gt;Rufus&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;在Windows上使用Rufus工具，将系统镜像文件写入到U盘。&lt;/p&gt;
&lt;h3 id="安装过程"&gt;安装过程&lt;/h3&gt;
&lt;p&gt;参考以下步骤完成安装&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;重启计算机进入bios设置开机顺序（找到在StartUp选项修改，设置usb优先启动），或重启时直接按F12（或其他FN)或Enter等进入设置（不同主板进入方法可能不同）。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;启动进入了ubuntu安装引导界面，开始安装过程&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src="getting-started-with-ubuntu.assets/img-2021-10-05-16-59-25.png" alt="安装引导界面"&gt;&lt;/p&gt;
&lt;p&gt;-[连接网络]&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;说明一下，如果选择安装第三方软件，安装过程耗时较长，如果网速很慢的话，建议先不安装，可安装好系统后在使用时根据系统提示安装。网速快的话就另当别论了。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;[安装类型]&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src="getting-started-with-ubuntu.assets/img-2021-10-05-18-09-14.png" alt=""&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;调整分区&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;此处可以设置管理员账户，建议耐心点一次设置好就ok了&lt;/p&gt;
&lt;p&gt;&lt;img src="getting-started-with-ubuntu.assets/img-2021-10-05-18-09-35.png" alt="用户"&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;开始安装&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src="getting-started-with-ubuntu.assets/img-2021-10-05-18-10-09.png" alt=""&gt;&lt;/p&gt;
&lt;p&gt;安装完成后，重新启动计算机就ok了！&lt;/p&gt;
&lt;p&gt;&lt;img src="getting-started-with-ubuntu.assets/img-2021-10-05-18-10-22.png" alt=""&gt;&lt;/p&gt;
&lt;h3 id="从旧磁盘迁移ubuntu"&gt;从旧磁盘迁移Ubuntu&lt;/h3&gt;
&lt;p&gt;有时由于更换磁盘等原因，我们需要迁移Linux系统到新的磁盘。这里给出一个本人使用过的解决方案。
假设问题： 需要将HDD上装有Ubuntu 18.04的Linux系统迁移到一块空的SSD上。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在新磁盘上创建分区(这里我只创建了一个root分区，且原系统也只有一个分区)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;使用&lt;a href="https://gparted.org/"&gt;gparted&lt;/a&gt;在新磁盘上创建一个root分区,格式为ext4.
或者在终端下使用&lt;a href="http://manpages.ubuntu.com/manpages/xenial/man8/parted.8.html"&gt;parted&lt;/a&gt;完成该操作。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;将系统文件拷贝到新磁盘的分区(建议在&lt;a href="http://www.ubuntu.com/download/desktop/create-a-usb-stick-on-ubuntu"&gt;live usb&lt;/a&gt;上完成该操作)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# 旧的分区在/dev/sda5上， 新磁盘为/dev/sdb&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;dd &lt;span style="color:#033"&gt;in&lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;/dev/sda5 &lt;span style="color:#033"&gt;of&lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;/dev/sdb1 &lt;span style="color:#033"&gt;bs&lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;4M &lt;span style="color:#033"&gt;conv&lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;noerror,sync &lt;span style="color:#033"&gt;status&lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;progress
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;拷贝完后，mount新磁盘确认数据已经保存到新磁盘，就可以移走旧磁盘或删除旧系统文件。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;使用live usb安装grub到新磁盘的文件系统&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# mount新磁盘分区到 /mnt&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo mount /dev/sdb1 /mnt
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# mount当前操作系统文件必要目录&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#069;font-weight:bold"&gt;for&lt;/span&gt; i in sys proc run dev; &lt;span style="color:#069;font-weight:bold"&gt;do&lt;/span&gt; sudo mount --bind &lt;span style="color:#c30"&gt;&amp;#34;/&lt;/span&gt;&lt;span style="color:#033"&gt;$i&lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;&lt;/span&gt; &lt;span style="color:#c30"&gt;&amp;#34;/mnt/&lt;/span&gt;&lt;span style="color:#033"&gt;$i&lt;/span&gt;&lt;span style="color:#c30"&gt;&amp;#34;&lt;/span&gt;; &lt;span style="color:#069;font-weight:bold"&gt;done&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# 如果使用的是UEFI系统，也需要将它mount到mnt，这里我的UEFI在/dev/sda1上，可通过磁盘工具查看&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo mount /dev/sda1 /mnt/boot/efi
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# chroot&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo chroot /mnt
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# 更新grub&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;update-grub
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;grub-install /dev/sdb
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;update-grub
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#366"&gt;exit&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# 重启&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo reboot
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;创建swapfile (可选，如果启动时提示无swapfile使用)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;首先确认swap文件是否存在 &lt;code&gt;sudo swapon -s&lt;/code&gt;&lt;/p&gt;</description></item><item><title>分布式事务</title><link>https://qtopie.github.io/notes/system-design/tcc/</link><pubDate>Sun, 23 Aug 1970 09:10:29 +0000</pubDate><guid>https://qtopie.github.io/notes/system-design/tcc/</guid><description>&lt;h2 id="基础理论"&gt;基础理论&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ACID&lt;/strong&gt;：原子性（Atomicity）、一致性（Consistency）、隔离性（Isolation）、持久性（Durability）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CAP&lt;/strong&gt;：一致性（Consistency）、可用性（Availability）、分区容忍性（Partition tolerance）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;BASE&lt;/strong&gt;：基本可用（Basically Available）、软状态（Soft State）、最终一致性（Eventually Consistent）。&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="2pc两阶段提交"&gt;2PC（两阶段提交）&lt;/h2&gt;
&lt;p&gt;两阶段提交（Two-Phase Commit, 2PC）是一种经典的分布式事务协议，用于确保多个分布式系统中的操作要么全部成功，要么全部失败，保证数据一致性。&lt;/p&gt;
&lt;h3 id="流程"&gt;流程&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;准备阶段（Prepare Phase）&lt;/strong&gt;&lt;br&gt;
协调者（Coordinator）向所有参与者（Participant）发送准备提交请求（prepare）。&lt;br&gt;
参与者执行本地事务操作，但不提交，只写入预提交日志，并锁定相关资源。&lt;br&gt;
参与者将执行结果（可以提交/不能提交）反馈给协调者。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;提交阶段（Commit Phase）&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;如果所有参与者都反馈“可以提交”，协调者向所有参与者发送提交（commit）请求，参与者正式提交本地事务，释放资源。&lt;/li&gt;
&lt;li&gt;如果有任何一个参与者反馈“不能提交”或超时未响应，协调者向所有参与者发送回滚（rollback）请求，参与者回滚本地事务，释放资源。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-mermaid" data-lang="mermaid"&gt;flowchart TD
 A[事务发起者发起TCC事务] --&amp;gt; B{各参与者Try阶段&amp;lt;br&amp;gt;预留资源}
 B -- 所有Try成功 --&amp;gt; C[各参与者Confirm阶段&amp;lt;br&amp;gt;正式提交]
 C --&amp;gt; D[事务完成]
 B -- 有Try失败或超时 --&amp;gt; E[各参与者Cancel阶段&amp;lt;br&amp;gt;释放资源/回滚]
 E --&amp;gt; D
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id="优缺点"&gt;优缺点&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;优点&lt;/strong&gt;：实现简单，能保证强一致性。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;缺点&lt;/strong&gt;：同步阻塞，性能较低；协调者单点故障会导致参与者长时间锁定资源，存在阻塞和脑裂风险。&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;2PC 常用于分布式数据库、消息队列等场景。实际生产环境中，通常会用 TCC、SAGA 等更灵活的方案来替代 2PC。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h2 id="3pc三阶段提交"&gt;3PC（三阶段提交）&lt;/h2&gt;
&lt;p&gt;三阶段提交（Three-Phase Commit, 3PC）是在 2PC 基础上改进的一种分布式事务协议，主要目的是减少协调者单点故障导致的阻塞和脑裂风险。3PC 将提交过程分为三个阶段：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;CanCommit 阶段（询问阶段）&lt;/strong&gt;&lt;br&gt;
协调者向所有参与者发送“是否可以提交”请求（canCommit）。&lt;br&gt;
参与者收到后判断自己是否可以执行事务，并反馈“可以”或“不可以”。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;PreCommit 阶段（预提交阶段）&lt;/strong&gt;&lt;br&gt;
如果所有参与者都同意可以提交，协调者发送“预提交”请求（preCommit）。&lt;br&gt;
参与者收到后执行事务操作并写入预提交日志，但还未正式提交，并反馈“已预提交”。&lt;br&gt;
此时参与者可以安全地提交事务，但如果出现故障也可以回滚。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;DoCommit 阶段（正式提交阶段）&lt;/strong&gt;&lt;br&gt;
协调者收到所有参与者的“已预提交”反馈后，发送“正式提交”请求（doCommit）。&lt;br&gt;
参与者收到后正式提交事务并释放资源。&lt;/p&gt;</description></item><item><title>OAuth</title><link>https://qtopie.github.io/notes/system-design/oauth/</link><pubDate>Sun, 23 Aug 1970 06:28:43 +0000</pubDate><guid>https://qtopie.github.io/notes/system-design/oauth/</guid><description>&lt;pre tabindex="0"&gt;&lt;code&gt; +--------+ +---------------+
 | |--(A)- Authorization Request -&amp;gt;| Resource |
 | | | Owner |
 | |&amp;lt;-(B)-- Authorization Grant ---| |
 | | +---------------+
 | |
 | | +---------------+
 | |--(C)-- Authorization Grant --&amp;gt;| Authorization |
 | Client | | Server |
 | |&amp;lt;-(D)----- Access Token -------| |
 | | +---------------+
 | |
 | | +---------------+
 | |--(E)----- Access Token ------&amp;gt;| Resource |
 | | | Server |
 | |&amp;lt;-(F)--- Protected Resource ---| |
 +--------+ +---------------+
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="相关安全问题"&gt;相关安全问题&lt;/h2&gt;
&lt;h3 id="csrf-cross-site-request-forgery"&gt;CSRF (Cross Site Request Forgery)&lt;/h3&gt;
&lt;p&gt;CSRF（Cross-site request forgery，跨站请求伪造），也被称为“One Click Attack”或Session Riding，通常缩写为CSRF或者XSRF，是基于客户端操作的请求伪造，是一种对网站的恶意利用。&lt;/p&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/ai/mcp-notes/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/ai/mcp-notes/</guid><description/></item><item><title/><link>https://qtopie.github.io/notes/algorithms/bitwise-operators/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/algorithms/bitwise-operators/</guid><description>&lt;h1 id="bitwise-operators"&gt;Bitwise Operators&lt;/h1&gt;
&lt;h2 id="list"&gt;List&lt;/h2&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Operator&lt;/th&gt;
 &lt;th&gt;Sign&lt;/th&gt;
 &lt;th&gt;example&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;AND&lt;/td&gt;
 &lt;td&gt;&amp;amp;&lt;/td&gt;
 &lt;td&gt;1 &amp;amp; 1 = 1&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;OR&lt;/td&gt;
 &lt;td&gt;|&lt;/td&gt;
 &lt;td&gt;1 | 0 = 1&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;XOR&lt;/td&gt;
 &lt;td&gt;^&lt;/td&gt;
 &lt;td&gt;1 ^ 0 = 1&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;left shift&lt;/td&gt;
 &lt;td&gt;&amp;laquo;&lt;/td&gt;
 &lt;td&gt;1 &amp;laquo; 1 = 2&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;right shift&lt;/td&gt;
 &lt;td&gt;&amp;raquo;&lt;/td&gt;
 &lt;td&gt;1 &amp;raquo; 1 = 0&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;NOT&lt;/td&gt;
 &lt;td&gt;~&lt;/td&gt;
 &lt;td&gt;~10101 = 1010&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="application"&gt;Application&lt;/h2&gt;
&lt;h3 id="data-integrity"&gt;data integrity&lt;/h3&gt;
&lt;h2 id="reference"&gt;Reference&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.geeksforgeeks.org/bitwise-operators-in-c-cpp/"&gt;bitwise-operators-in-c-cpp, GeeksforGeeks&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/algorithms/linked-list.zh/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/algorithms/linked-list.zh/</guid><description>&lt;h1 id="链表"&gt;链表&lt;/h1&gt;
&lt;h2 id="链表反转"&gt;链表反转&lt;/h2&gt;
&lt;h2 id="判断链表是否有环"&gt;判断链表是否有环&lt;/h2&gt;
&lt;p&gt;解法: 指针内存地址Hash, 快慢双指针(追及问题)&lt;/p&gt;
&lt;p&gt;内存地址Hash的思路是将遍历过的记录存储下来, 然后把当前访问的节点与历史节点进行比较.&lt;/p&gt;
&lt;p&gt;快慢双指针: 定义一个慢指针slow, 一个快指针fast, 慢指针走一次时快指针走两次.
根据物理知识, 如果链表有环, 快指针一定会追上慢指针. 而且快指针走的步数一定是慢指针的两倍, 因为快指针每次只能追赶一步, 追上的时候也就在一起了.&lt;/p&gt;
&lt;p&gt;如果fast和slow中间间隔一个,则本次追不上&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;fast -&amp;gt; node2 -&amp;gt; slow -&amp;gt; node4
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;fast和slow相邻的时候,下次追上&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;fast -&amp;gt; slow -&amp;gt; node5
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;怎么找到环开始的点?&lt;/p&gt;
&lt;p&gt;因为快指针走的路是慢指针的两倍, 慢指针走完一圈,恰好回到环开始的地方. 而当两个指针相遇的时候, (先假设快指针恰好多走一圈)&lt;/p&gt;
&lt;p&gt;快慢指针同时走, 慢指针走完终点, 则快指针走完一圈再加上从开头到环入口的路才刚好走完链表的两次遍历.&lt;/p&gt;
&lt;p&gt;所以如果快慢指针相遇时, 从链表开头到环入口的距离和相遇点到环入口的距离相等.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;判断两个链表是否相交及求相交的部分&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="reference"&gt;Reference&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;link1&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/algorithms/readme/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/algorithms/readme/</guid><description>&lt;p&gt;Algorithm and Data Structures&lt;/p&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/algorithms/selection-algorithm/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/algorithms/selection-algorithm/</guid><description>&lt;h1 id="selection-algorithm"&gt;Selection Algorithm&lt;/h1&gt;
&lt;h2 id="median-of-medians"&gt;Median of medians&lt;/h2&gt;
&lt;h3 id="bfprt"&gt;BFPRT&lt;/h3&gt;
&lt;h2 id="reference"&gt;Reference&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://speople.csail.mit.edu/rivest/pubs/BFPRT73.pdf"&gt;http://speople.csail.mit.edu/rivest/pubs/BFPRT73.pdf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://en.wikipedia.org/wiki/Median_of_medians"&gt;https://en.wikipedia.org/wiki/Median_of_medians&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/algorithms/sort/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/algorithms/sort/</guid><description>&lt;h1 id="timsort--quicksortdual-pivot"&gt;TimSort &amp;amp; QuickSort(dual-pivot)&lt;/h1&gt;
&lt;h2 id="timsort"&gt;TimSort&lt;/h2&gt;
&lt;h3 id="reference"&gt;Reference&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.geeksforgeeks.org/timsort/"&gt;https://www.geeksforgeeks.org/timsort/&lt;/a&gt; (simplified version)&lt;/li&gt;
&lt;li&gt;&lt;a href="http://cr.openjdk.java.net/~martin/webrevs/openjdk7/timsort/raw_files/new/src/share/classes/java/util/TimSort.java"&gt;http://cr.openjdk.java.net/~martin/webrevs/openjdk7/timsort/raw_files/new/src/share/classes/java/util/TimSort.java&lt;/a&gt; (OpenJDK version)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="dual-pivot-quicksort"&gt;Dual pivot QuickSort&lt;/h2&gt;
&lt;h3 id="reference-1"&gt;Reference&lt;/h3&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/cloud-native/cicd/jenkins/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/cloud-native/cicd/jenkins/</guid><description>&lt;p&gt;&lt;a href="https://github.com/jenkinsci/kubernetes-plugin"&gt;https://github.com/jenkinsci/kubernetes-plugin&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;war file is uncompressed under /var/jenkins_home/war&lt;/p&gt;
&lt;p&gt;Class files are random accessed. Not recommmend to mount with s3 (fuse), will make page slow.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/jenkinsci/kubernetes-plugin/blob/master/src/main/kubernetes/service-account.yml"&gt;https://github.com/jenkinsci/kubernetes-plugin/blob/master/src/main/kubernetes/service-account.yml&lt;/a&gt;&lt;/p&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/cloud-native/docker/readme/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/cloud-native/docker/readme/</guid><description>&lt;p&gt;Docker config&lt;/p&gt;
&lt;p&gt;&lt;a href="https://medium.com/better-programming/about-using-docker-config-e967d4a74b83"&gt;https://medium.com/better-programming/about-using-docker-config-e967d4a74b83&lt;/a&gt;&lt;/p&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/cloud-native/k8s/kube-cluster-with-multipass/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/cloud-native/k8s/kube-cluster-with-multipass/</guid><description>&lt;h1 id="kubenetes-cluster-with-multipass"&gt;Kubenetes cluster with multipass&lt;/h1&gt;
&lt;h2 id="reference"&gt;Reference&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.digitalocean.com/community/tutorials/how-to-use-cloud-config-for-your-initial-server-setup#goals"&gt;Simple Guide to use cloud-init&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://cloud-init.io/"&gt;Official Cloud-init site&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/cloud-native/k8s/readme/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/cloud-native/k8s/readme/</guid><description>&lt;h2 id="quick-introduction"&gt;Quick Introduction&lt;/h2&gt;
&lt;h2 id="get-started"&gt;Get started&lt;/h2&gt;
&lt;h2 id="installation"&gt;Installation&lt;/h2&gt;
&lt;h2 id="shared-network-via-service"&gt;Shared network via service&lt;/h2&gt;
&lt;h2 id="volume-sharing"&gt;volume sharing&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://github.com/ctrox/csi-s3"&gt;https://github.com/ctrox/csi-s3&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="ingress-router"&gt;Ingress Router&lt;/h2&gt;
&lt;p&gt;Traefik&lt;/p&gt;
&lt;p&gt;&lt;a href="https://docs.traefik.io/"&gt;https://docs.traefik.io/&lt;/a&gt;&lt;/p&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/cloud-native/vault/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/cloud-native/vault/</guid><description>&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.hashicorp.com/resources/how-vault-compare-cloud-kms/"&gt;vault vs cloud kms&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/cloud-native/vitess/setup/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/cloud-native/vitess/setup/</guid><description>&lt;h1 id="quick-guide-for-vitess"&gt;Quick guide for vitess&lt;/h1&gt;
&lt;h2 id="addons"&gt;addons&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;microk8s enable dns hostpath-storage ingress&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;pull images behind firewall&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#033"&gt;https_proxy&lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;socks5://192.168.50.1:1080 microk8s.ctr image pull registry.k8s.io/ingress-nginx/controller:v1.5.1
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;check resources&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# list crd&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;mkctl get crd
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# list all resource names&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;mkctl api-resources --verbs&lt;span style="color:#555"&gt;=&lt;/span&gt;list -o name
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#09f;font-style:italic"&gt;# list viteness cluster kind resource&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;mkctl get VitessCluster
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="reference"&gt;Reference&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://vitess.io/docs/16.0/get-started/operator/"&gt;https://vitess.io/docs/16.0/get-started/operator/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/cloud-native/vitess/vitess-intro/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/cloud-native/vitess/vitess-intro/</guid><description>&lt;h1 id="vitess"&gt;Vitess&lt;/h1&gt;
&lt;p&gt;&lt;a href="https://vitess.io/"&gt;vitess&lt;/a&gt;是Google开发的可伸缩、可靠的、兼容MySQL的云原生分布式数据库。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;vitess最初由谷歌开发来支持youtube, 而youtube已成为全球第二大网站，有海量的视频上传和用户访问, 足以说明该方案的可靠性。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="为什么要分库分表"&gt;为什么要分库分表?&lt;/h2&gt;
&lt;p&gt;通常情况下，单库单表的方式就可以支撑绝大多数场景。&lt;/p&gt;
&lt;p&gt;如果流量较高，使用读写分离的方式也可以缓解数据库压力（一般读的流量比写高很多）。&lt;/p&gt;
&lt;p&gt;但如果记录有千万以上（或根据实际业务情况判断），当单机容量不够或单节点读写出现性能瓶颈时，就可以考虑分库分表来拆分流量了。&lt;/p&gt;
&lt;h2 id="分库分表方案"&gt;分库分表方案&lt;/h2&gt;
&lt;p&gt;通常分库分表有Embedded-SDK模式和Proxy模式。&lt;/p&gt;
&lt;p&gt;Embedded SDK模式的优点是，其部署架构更加简单，且去中心化。&lt;/p&gt;
&lt;p&gt;代表性的方案如sharding-jdbc, mycat等.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://shardingsphere.apache.org/document/legacy/3.x/document/img/sharding-jdbc-brief.png" alt="Sharding-JDBC Architecture"&gt;&lt;/p&gt;
&lt;p&gt;Proxy模式则对应用提供了类似标准JDBC或者DB SQL连接的方式，给应用开发者的感觉就是直接连数据库一样，基本不用关注实现细节。而且Proxy模式比较容易定制监控/自动扩缩容方案，因此运维成本一般较低。以及在代理层实现连接复用提高io性能。&lt;/p&gt;
&lt;p&gt;代表性的方案如vitess, sharding-proxy&lt;/p&gt;
&lt;p&gt;&lt;img src="https://shardingsphere.apache.org/document/legacy/3.x/document/img/sharding-proxy-brief_v2.png" alt="Sharding-Proxy Architecture"&gt;&lt;/p&gt;
&lt;p&gt;从另一个角度考虑，如果数据库要支持多个语言访问，Embedded-SDK模式就需要新的支持该语言的SDK；而Proxy模式则不用，只用标准JDBC连接即可。&lt;/p&gt;
&lt;h2 id="vitess特性"&gt;Vitess特性&lt;/h2&gt;
&lt;h2 id="vitess架构"&gt;Vitess架构&lt;/h2&gt;
&lt;p&gt;&lt;img src="https://vitess.io/docs/16.0/overview/img/architecture.svg" alt="Architecture Diagram"&gt;&lt;/p&gt;
&lt;p&gt;类似于Kubernetes, Viteness的组件分为Control Plane（控制切面）和Data Plane(数据切面两部分)。&lt;/p&gt;
&lt;p&gt;一般Control Plane承载元数据存储、调度和管理、监控等功能，而Data Plane直接对上游提供服务，承载业务流量。&lt;/p&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th style="text-align: center"&gt;名称&lt;/th&gt;
 &lt;th&gt;说明&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td style="text-align: center"&gt;VTGate&lt;/td&gt;
 &lt;td&gt;Vitess网关，将流量路由到VTTablet&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: center"&gt;VTTablet&lt;/td&gt;
 &lt;td&gt;一个tablet由一个mysqld进程和一个对应的vttablet进程组成，一般运行在一个机器上。&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: center"&gt;VTAdmin&lt;/td&gt;
 &lt;td&gt;Vitess Web管理界面&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: center"&gt;vtctld&lt;/td&gt;
 &lt;td&gt;用来访HTTP服务器，通常用来诊断集群的状态；也为vtctlclient提供服务&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: center"&gt;vtorc&lt;/td&gt;
 &lt;td&gt;vtorc即（Vitess Orchestration), 根据https://github.com/openark/orchestrator改写。主要实现mysql实例集群的复制和高可用&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;其他比较重要的概念&lt;/p&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th style="text-align: center"&gt;名称&lt;/th&gt;
 &lt;th&gt;说明&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td style="text-align: center"&gt;Keyspace&lt;/td&gt;
 &lt;td&gt;keyspace是一个逻辑上的数据库。如果不使用sharding, 它会直接映射到数据库名称; 使用sharding时，它会映射到多个mysql分库。&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: center"&gt;Shard&lt;/td&gt;
 &lt;td&gt;Shard是keyspace的子集，通常是一个MySQL主库和多个MySQL从库&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: center"&gt;VSchema&lt;/td&gt;
 &lt;td&gt;VSchema用来定义如何分库分表，即如何数据如何存储在keyspaces和shards。 通在路由查询和重新分片的时候用到&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td style="text-align: center"&gt;Cell&lt;/td&gt;
 &lt;td&gt;Cell是一组servers的集合，通常是在一个可用区(availability zone)里面，与其他的cell冗灾。每一个cell有自己的拓扑服务，如上面的架构图。&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;TODO 多个cell的场景&lt;/p&gt;
&lt;h2 id="本地运行官方示例"&gt;本地运行官方示例&lt;/h2&gt;
&lt;p&gt;Vitess官方提供了&lt;a href="https://vitess.io/docs/16.0/get-started/operator/"&gt;Vitess Operator for Kubernetes&lt;/a&gt; 教程，通过Kubernetes起一个近似生产环境的集群。&lt;/p&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/design-patterns/design-principles/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/design-patterns/design-principles/</guid><description>&lt;h1 id="design-principles"&gt;Design Principles&lt;/h1&gt;
&lt;h2 id="dependency-injection-di"&gt;Dependency Injection (DI)&lt;/h2&gt;
&lt;p&gt;With dependency injection, objects accept dependencies in their constructors.
The core principle is to separate behaviour from dependency resolution.&lt;/p&gt;
&lt;p&gt;Compared with Direct constructor calls:&lt;/p&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;direct constructor calls&lt;/th&gt;
 &lt;th&gt;Dependency Injection&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;direct, compile-time dependency&lt;/td&gt;
 &lt;td&gt;dependencies injection&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;problems for modularity and testability&lt;/td&gt;
 &lt;td&gt;dependencies are not hidden in codes&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;See &lt;a href="https://github.com/google/guice/wiki/Motivation"&gt;Motivation of guice&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Sample: &lt;a href="https://github.com/google/guice/wiki/GettingStarted"&gt;https://github.com/google/guice/wiki/GettingStarted&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="inversion-of-control-ioc"&gt;(Inversion of Control) IoC&lt;/h2&gt;
&lt;p&gt;参考维基百科 &lt;a href="https://zh.wikipedia.org/wiki/%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC"&gt;控制反转&lt;/a&gt;：
&lt;code&gt;早在2004年，Martin Fowler就提出了“哪些方面的控制被反转了？”这个问题。他总结出是依赖对象的获得被反转了，因为大多数应用程序都是由两个或是更多的类通过彼此的合作来实现企业逻辑，这使得每个对象都需要获取与其合作的对象（也就是它所依赖的对象）的引用。如果这个获取过程要靠自身实现，那么这将导致代码高度耦合并且难以维护和调试。&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Common implementation methods
&lt;ul&gt;
&lt;li&gt;Dependency Injection&lt;/li&gt;
&lt;li&gt;Dependency Lookup (ServiceReistry)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="aop"&gt;AOP&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;In computing, aspect-oriented programming (AOP) is a programming paradigm that aims to increase modularity by allowing the separation of cross-cutting concerns. It does so by adding additional behavior to existing code (an advice) without modifying the code itself, instead separately specifying which code is modified via a &amp;quot;pointcut&amp;quot; specification, such as &amp;quot;log all function calls when the function's name begins with 'set'&amp;quot;. This allows behaviors that are not central to the business logic (such as logging) to be added to a program without cluttering the code, core to the functionality. AOP forms a basis for aspect-oriented software development.&lt;/code&gt;&lt;/p&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/design-patterns/iterator/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/design-patterns/iterator/</guid><description>&lt;p&gt;供一种方法来访问聚合对象，而不用暴露这个对象的内部表示，其别名为游标(Cursor)。迭代器模式是一种对象行为型模式。&lt;/p&gt;
&lt;p&gt;&lt;a href="https://blog.csdn.net/yanbober/article/details/45497881"&gt;https://blog.csdn.net/yanbober/article/details/45497881&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;java prev and next traverse
&lt;a href="https://docs.oracle.com/javase/8/docs/api/java/util/ListIterator.html"&gt;https://docs.oracle.com/javase/8/docs/api/java/util/ListIterator.html&lt;/a&gt;&lt;/p&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/iot/asus-router/merlin-firmware/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/iot/asus-router/merlin-firmware/</guid><description>&lt;h1 id="asus-router-with-merlin-firmware"&gt;ASUS Router with Merlin Firmware&lt;/h1&gt;
&lt;p&gt;AiMesh Devices&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;RT-AX82U (Master)&lt;/li&gt;
&lt;li&gt;ZenWifi XD4 (RT-AX56-XD4)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="firmware"&gt;Firmware&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://github.com/gnuton/asuswrt-merlin.ng"&gt;https://github.com/gnuton/asuswrt-merlin.ng&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="jffs-partition"&gt;&lt;code&gt;jffs&lt;/code&gt; partition&lt;/h2&gt;
&lt;p&gt;User Scripts: &lt;code&gt;/jffs/scripts&lt;/code&gt; &lt;a href="https://github.com/RMerl/asuswrt-merlin.ng/wiki/User-scripts"&gt;https://github.com/RMerl/asuswrt-merlin.ng/wiki/User-scripts&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="run-scripts-on-boot"&gt;Run scripts on boot&lt;/h2&gt;
&lt;!-- ```bash
nvram set script_usbhotplug="sh /jffs/configs/usb-mount-hook.sh"
nvram commit
service reboot
```

&gt; Tips of `nvram` utility
&gt; command to show all configs: `nvram show`
&gt; set config: `nvram set &lt;config-key:config-value&gt;`
&gt; query config: `nvram get &lt;config-key&gt;` --&gt;
&lt;p&gt;&lt;code&gt;/jffs/scripts/post-mount&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#099"&gt;#!/bin/sh
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#099"&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#069;font-weight:bold"&gt;if&lt;/span&gt; &lt;span style="color:#555"&gt;[&lt;/span&gt; &lt;span style="color:#033"&gt;$1&lt;/span&gt; &lt;span style="color:#555"&gt;==&lt;/span&gt; &lt;span style="color:#c30"&gt;&amp;#34;/tmp/mnt/usb&amp;#34;&lt;/span&gt; &lt;span style="color:#555"&gt;]&lt;/span&gt; &lt;span style="color:#555"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style="color:#555"&gt;[&lt;/span&gt; -e &lt;span style="color:#c30"&gt;&amp;#34;/mnt/usb/scripts/startup.sh&amp;#34;&lt;/span&gt; &lt;span style="color:#555"&gt;]&lt;/span&gt;; &lt;span style="color:#069;font-weight:bold"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; bash -c &lt;span style="color:#c30"&gt;&amp;#34;/mnt/usb/scripts/startup.sh&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#069;font-weight:bold"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;content of &lt;code&gt;usb-mount-hook.sh&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Test whether file exists, then execute script if found&lt;/p&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/iot/rpi/portable-5g/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/iot/rpi/portable-5g/</guid><description>&lt;h1 id="树莓派5g-nr上网折腾记"&gt;树莓派5G NR上网折腾记&lt;/h1&gt;
&lt;h2 id="背景"&gt;背景&lt;/h2&gt;
&lt;p&gt;每年春节回老家过年的时候，都需要解决上网的问题。基本需求是, 需要通过路由器为家里的电视、手机等设备提供一个可靠的网络覆盖，&lt;/p&gt;
&lt;p&gt;而且网络的质量需要满足要求。因为平时不在老家住，开通宽带一般需要按年计费，不太划算。所以之前也尝试过买流量卡, 一个月可能&lt;/p&gt;
&lt;p&gt;有几十G流量，然后使用树莓派和4G模块上网，共享网络给路由器满足需求。2020年春节期间隔离在家，不得不在家办公一个月,&lt;/p&gt;
&lt;p&gt;还开通过电信宽带。当时用的是电信129元十全十美套餐，绑定银行卡优惠30元（当时没想着长期用，就没绑定 ：&amp;lt; ), 因为合约期两年&lt;/p&gt;
&lt;p&gt;后面出去打工后就没管了，送的三张卡也没有用。后面却发现欠费好几百，考虑可能影响到个人征信，因此又补缴了费用。相当于没有使用&lt;/p&gt;
&lt;p&gt;却给电信捐款， 略坑。 因此一直在调研其他的方案，来满足春节短期的上网需求。&lt;/p&gt;
&lt;p&gt;由于宽带一般都需要长期开通，成本才会降低。而且在人口密集的城市和乡村地区，宽带价格差异很大。基层业务人员服务也不够好,&lt;/p&gt;
&lt;p&gt;一不小心又会掉进坑里。所以宽带不是一个好的选择。&lt;/p&gt;
&lt;p&gt;5G网络的全国覆盖已经比较广了，其实4G+的网速(150Mbps~300Mbps)已经可以满足绝大多数上网场景的需求。&lt;/p&gt;
&lt;p&gt;而且国内的电信运营商, 如果设备支持5G的话，就算使用的是4G套餐，也会支持5G的网络。虽然会被限速，但网速依然会提升不少，延迟也相对较低。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;毕竟5G设备已经安装在那里，不用的话也会浪费。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;所以树莓派+5G上网模块就是一个好的选择。 剩下要做的事情就是选择一个可靠且实惠的5G上网模块和套餐资费了。&lt;/p&gt;
&lt;p&gt;这里不进行比较，我选择的方案就是 Rapsberrry Pi 3 + RM500U-CN + 天际通卡.&lt;/p&gt;
&lt;p&gt;作为一个树莓派粉，设备我当然有了，而且每一代都有(还是在低位入手的）, 暂时不计成本。&lt;/p&gt;
&lt;p&gt;RM500U-CN 大概需要 900块。&lt;/p&gt;
&lt;p&gt;天际通卡一年资费500多，但有按月的套餐99/月， 一个月的流量2000GB。非常适合我的需求。&lt;/p&gt;
&lt;p&gt;虽然整体成本要1000+, 比一年的100M宽带价格 800左右并没有便宜多少。 但是设备是买到是我自己的，我还可以继续折腾，&lt;/p&gt;
&lt;p&gt;从物品和精神上也都保值呢。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;这比开通了宽带但是没有使用依然扣费划算不少，可能只是心理舒坦 :&amp;gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="rm500-cn"&gt;RM500-CN&lt;/h3&gt;
&lt;p&gt;RM500U-CN是一款相对物美价廉的产品，微雪电子对其定制了扩展版和外壳天线等，简单的组装一下就可以比的上商业产品的质量。&lt;/p&gt;
&lt;p&gt;&lt;a href="https://www.waveshare.net/shop/RM500U-CN-5G-HAT-with-case.htm"&gt;RM500U-CN商品链接&lt;/a&gt;&lt;/p&gt;
&lt;h3 id="天际通卡"&gt;天际通卡&lt;/h3&gt;
&lt;p&gt;天际通14001号码的卡支持SA网络， 14000的不支持。可以通过卡后面的号码区分。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;为了保证能买到14001卡, 我从闲鱼上找卖家购买并确认。 一般来说，华为移动路由设备送的卡是14001卡。
我买的那张卡, 应该是闲鱼卖家从回收的华为设备里单独拿出来卖的；
一个技巧是, 确认这个卡没有人使用，自己可以实名认证，防止用别人的卡充值后被别人挂失找回，造成不必要的经济损失&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="组装"&gt;组装&lt;/h2&gt;
&lt;p&gt;组装教程 &lt;a href="https://www.waveshare.net/w/upload/8/8b/PI4-CASE-4G-5G-M.2-Assembly-cn.jpg"&gt;https://www.waveshare.net/w/upload/8/8b/PI4-CASE-4G-5G-M.2-Assembly-cn.jpg&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;实际上按照从底部往上组装的顺序比较容易。&lt;/p&gt;
&lt;p&gt;因为我们用的是RM500U-CN, 是通过usb(不是gpio）共享扩展版的网络到树莓派，所以需要插好A-to-A的USB接口.&lt;/p&gt;
&lt;h2 id="调试和使用"&gt;调试和使用&lt;/h2&gt;
&lt;p&gt;这里推荐安装ubuntu-server 20.04, 经测试可以运行。而且ubuntu对树莓派本身也有良好的支持，是raspbian的近亲。&lt;/p&gt;
&lt;p&gt;安装好ubuntu-server后，根据waveshare提供的补丁，添加USB设备描述符(vendor ID/product ID)&lt;/p&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/java/aqs/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/java/aqs/</guid><description>&lt;h1 id="aqs"&gt;AQS&lt;/h1&gt;
&lt;p&gt;Java AQS（AbstractQueuedSynchronizer）是Java并发包（java.util.concurrent）中的一个基础同步框架。它为实现锁和其他同步器（如Semaphore、CountDownLatch、ReentrantLock等）提供了一个通用的底层机制。&lt;/p&gt;
&lt;p&gt;核心特点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;基于FIFO队列：AQS通过一个基于FIFO的等待队列管理线程的同步状态。
独占与共享模式：支持独占（如ReentrantLock）和共享（如Semaphore）两种资源获取方式。&lt;/li&gt;
&lt;li&gt;状态管理：通过一个int类型的state变量表示同步状态，子类通过继承AQS并重写相关方法实现自定义同步器。&lt;/li&gt;
&lt;li&gt;阻塞与唤醒：AQS负责线程的阻塞与唤醒，简化了同步器的实现。
常见用法：&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;实现自定义锁或同步器时，继承AQS并实现tryAcquire、tryRelease等方法。
AQS极大地简化了Java并发工具的开发，是Java并发包的核心基础&lt;/p&gt;
&lt;h3 id="数据结构"&gt;数据结构&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Node&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-java" data-lang="java"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#069;font-weight:bold"&gt;abstract&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;static&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;class&lt;/span&gt; &lt;span style="color:#0a8;font-weight:bold"&gt;Node&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;{&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;volatile&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;Node&lt;span style="color:#bbb"&gt; &lt;/span&gt;prev;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// initially attached via casTail&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;volatile&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;Node&lt;span style="color:#bbb"&gt; &lt;/span&gt;next;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// visibly nonnull when signallable&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;Thread&lt;span style="color:#bbb"&gt; &lt;/span&gt;waiter;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// visibly nonnull when enqueued&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#069;font-weight:bold"&gt;volatile&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#078;font-weight:bold"&gt;int&lt;/span&gt;&lt;span style="color:#bbb"&gt; &lt;/span&gt;status;&lt;span style="color:#bbb"&gt; &lt;/span&gt;&lt;span style="color:#09f;font-style:italic"&gt;// written by owner, atomic bit ops by others&lt;/span&gt;&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#bbb"&gt;&lt;/span&gt;}&lt;span style="color:#bbb"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;CLH队列&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;CLH队列（Craig, Landin, and Hagersten队列）是一种基于链表的自旋锁队列，AQS的同步队列就是基于CLH队列实现的。&lt;/p&gt;
&lt;p&gt;特点：&lt;/p&gt;
&lt;p&gt;CLH队列是一个虚链表，节点代表等待获取锁的线程。
每个线程在本地保存一个前驱节点，通过前驱节点的状态判断自己是否可以获取锁。
线程入队时会自旋等待前驱节点释放锁，减少了竞争和CPU资源浪费。
在AQS中的应用：&lt;/p&gt;
&lt;p&gt;AQS通过CLH队列实现线程的有序排队和唤醒。
线程获取锁失败时，会被包装成一个Node节点加入队列尾部。
只有队列头节点的下一个节点才有资格被唤醒尝试获取锁，保证了公平性。
CLH队列的设计让AQS能够高效地管理大量线程的同步等待。&lt;/p&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/java/jvm/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/java/jvm/</guid><description>&lt;h2 id="g1"&gt;G1&lt;/h2&gt;
&lt;p&gt;G1垃圾回收的过程&lt;/p&gt;
&lt;p&gt;如何实现maxPauseTime&lt;/p&gt;
&lt;p&gt;G1的特点, 优点和缺点&lt;/p&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/java/monitor/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/java/monitor/</guid><description>&lt;h2 id="参考"&gt;参考&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://stackoverflow.com/questions/49610644/in-java-what-is-the-difference-between-a-monitor-and-a-lock"&gt;Java Monitor&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/linux/the-little-linux-cmd-book/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/linux/the-little-linux-cmd-book/</guid><description>&lt;h1 id="the-little-linux-command-line-book"&gt;The Little Linux Command Line Book&lt;/h1&gt;
&lt;h2 id="cpu"&gt;CPU&lt;/h2&gt;
&lt;p&gt;top&lt;/p&gt;
&lt;h2 id="memory"&gt;Memory&lt;/h2&gt;
&lt;p&gt;virtual memory
swapfile&lt;/p&gt;
&lt;p&gt;&lt;code&gt;free&lt;/code&gt; command&lt;/p&gt;
&lt;h2 id="io"&gt;I/O&lt;/h2&gt;</description></item><item><title/><link>https://qtopie.github.io/notes/web/quic/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/web/quic/</guid><description>&lt;h1 id="quic"&gt;QUIC&lt;/h1&gt;
&lt;p&gt;需要 HTTP/3 的主要原因是为了解决 HTTP/1.1 和 HTTP/2 在使用 TCP 协议时遇到的性能瓶颈和限制，尤其是在存在丢包和网络切换的情况下。&lt;/p&gt;
&lt;p&gt;以下是需要 HTTP/3 的几个关键原因：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;解决 TCP 的队头阻塞 (Head-of-Line Blocking - HOLB) 问题：&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;HTTP/1.1 的 HOLB:&lt;/strong&gt; 在 HTTP/1.1 中，即使开启了 Pipelining（尽管实际应用中问题很多），在一个连接上，前一个请求的响应必须完全接收后，下一个请求的响应才能开始发送。如果中间某个请求或响应被阻塞，后续的所有请求都会被延迟。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;HTTP/2 的 TCP HOLB:&lt;/strong&gt; HTTP/2 通过多路复用（Multiplexing）解决了应用层的 HOLB，允许在同一个 TCP 连接上同时发送多个请求和接收多个响应。然而，HTTP/2 仍然运行在 TCP 协议之上。TCP 是一个保证可靠和有序传输的协议，它要求数据包按顺序到达。如果在传输过程中，某个 TCP 数据包丢失了，TCP 会暂停整个连接的数据传输，直到丢失的数据包被重传并正确插入到序列中。这意味着，即使丢失的数据包只影响到 HTTP/2 连接中的某一个流（Stream），整个连接上的所有其他流都会被这个丢包事件阻塞，等待重传完成。这就是 TCP 层的队头阻塞，它极大地影响了 HTTP/2 在丢包环境下的性能。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;HTTP/3 (基于 QUIC) 的解决方案：&lt;/strong&gt; HTTP/3 使用了基于 UDP 的 QUIC 协议。QUIC 在应用层实现了类似 TCP 的可靠传输、流量控制和拥塞控制，但它是基于“流”来管理的。每个 HTTP 请求都被分配到一个独立的 QUIC 流。即使一个流中的数据包丢失，只会阻塞该流的传输，而同一连接上的其他流可以继续独立地传输数据，不会受到影响。这彻底解决了 TCP 层的 HOLB 问题，显著提升了在丢包率较高或网络不稳定的环境下的性能。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;更快的连接建立：&lt;/strong&gt;&lt;/p&gt;</description></item><item><title>Build and Try Fuchsia</title><link>https://qtopie.github.io/notes/fuchsia/get-started/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/fuchsia/get-started/</guid><description>&lt;h1 id="fuchsia"&gt;Fuchsia&lt;/h1&gt;
&lt;p&gt;&lt;a href="https://fuchsia.dev/fuchsia-src/get-started"&gt;https://fuchsia.dev/fuchsia-src/get-started&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="using-mirror"&gt;Using mirror&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://fuchsia.fsf.org.cn/#intro"&gt;https://fuchsia.fsf.org.cn/#intro&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;get tools&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;mkdir fuchsia &lt;span style="color:#555"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style="color:#366"&gt;cd&lt;/span&gt; fuchsia
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;curl --location --create-dirs --output .jiri_root/bin/cipd https://fuchsia.fsf.org.cn/bootstrap/cipd-linux-amd64
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;curl --location --create-dirs --output .jiri_root/bin/jiri https://fuchsia.fsf.org.cn/bootstrap/jiri-linux-amd64
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;chmod +x .jiri_root/bin/jiri .jiri_root/bin/jiri
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#366"&gt;export&lt;/span&gt; &lt;span style="color:#033"&gt;PATH&lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;&lt;span style="color:#a00"&gt;${&lt;/span&gt;&lt;span style="color:#033"&gt;PATH&lt;/span&gt;&lt;span style="color:#a00"&gt;}&lt;/span&gt;:&lt;span style="color:#a00"&gt;${&lt;/span&gt;&lt;span style="color:#033"&gt;PWD&lt;/span&gt;&lt;span style="color:#a00"&gt;}&lt;/span&gt;/.jiri_root/bin
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Download from mirror&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;mkdir -p build &lt;span style="color:#555"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span style="color:#366"&gt;echo&lt;/span&gt; &lt;span style="color:#c30"&gt;&amp;#34;internal_access = false&amp;#34;&lt;/span&gt; &amp;gt;build/cipd.gni
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;jiri init -keep-git-hooks&lt;span style="color:#555"&gt;=&lt;/span&gt;&lt;span style="color:#366"&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;jiri import -name&lt;span style="color:#555"&gt;=&lt;/span&gt;integration flower https://fuchsia.fsf.org.cn/git/fuchsia-integration
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;jiri update -v
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#366"&gt;echo&lt;/span&gt; &lt;span style="color:#c30"&gt;&amp;#34;have_firmware = false&amp;#34;&lt;/span&gt; &amp;gt;zircon/prebuilt/config.gni
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Switch back to official repos&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;rm -rf integration jiri .jiri_manifest .jiri_root
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;rm -rf integration jiri .jiri_manifest .jiri_root
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;curl -s https://fuchsia.googlesource.com/jiri/+/master/scripts/bootstrap_jiri?format&lt;span style="color:#555"&gt;=&lt;/span&gt;TEXT | base64 --decode | bash -s &lt;span style="color:#a00"&gt;${&lt;/span&gt;&lt;span style="color:#033"&gt;PWD&lt;/span&gt;&lt;span style="color:#a00"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;jiri init -keep-git-hooks&lt;span style="color:#555"&gt;=&lt;/span&gt;&lt;span style="color:#366"&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;jiri import -name&lt;span style="color:#555"&gt;=&lt;/span&gt;integration flower https://fuchsia.googlesource.com/integration
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;jiri update -v
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="proxy"&gt;proxy&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#366"&gt;export&lt;/span&gt; &lt;span style="color:#033"&gt;https_proxy&lt;/span&gt;&lt;span style="color:#555"&gt;=&lt;/span&gt;127.0.0.1:8118
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;use curl with socks5 proxy&lt;/p&gt;</description></item><item><title>Google IP地址范围</title><link>https://qtopie.github.io/notes/dev/google-ip-address/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/dev/google-ip-address/</guid><description>&lt;p&gt;google ip address range&lt;/p&gt;
&lt;p&gt;&lt;a href="https://www.gstatic.com/ipranges/goog.json"&gt;https://www.gstatic.com/ipranges/goog.json&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;github ip address range
&lt;a href="https://api.github.com/meta"&gt;https://api.github.com/meta&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="参考"&gt;参考&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://support.google.com/a/answer/10026322?hl=en"&gt;https://support.google.com/a/answer/10026322?hl=en&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/about-githubs-ip-addresses"&gt;https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/about-githubs-ip-addresses&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>xrdp</title><link>https://qtopie.github.io/notes/linux/remote-desktop-with-xrdp/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/linux/remote-desktop-with-xrdp/</guid><description>&lt;h1 id="xrdp"&gt;xrdp&lt;/h1&gt;
&lt;p&gt;&lt;em&gt;Connect to Ubuntu Desktop remotely with xrdp&lt;/em&gt;&lt;/p&gt;
&lt;h2 id="environment"&gt;Environment&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Win10 with hyper-v support&lt;/li&gt;
&lt;li&gt;Ubuntu Desktop 20.04&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="install-ubuntu-2004-on-win10-hyperv"&gt;Install Ubuntu 20.04 on win10-hyperv&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Download Ubuntu Desktop 20.04 from &lt;a href="https://ubuntu.com/download/desktop"&gt;here&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Search Hyper-V on win10 start menu and create a virtual machine with the ISO file you just downloaded&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Follow the installation guide provided by ubuntu iso media, and setup the OS&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;It&amp;rsquo;s recommended to use internal NAT network, so create a virtual network switch if necessary.&lt;/p&gt;</description></item><item><title>吉他扫弦</title><link>https://qtopie.github.io/notes/guitar/guitar-strum/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://qtopie.github.io/notes/guitar/guitar-strum/</guid><description>&lt;p&gt;掌握吉他扫弦（刷的节奏）是初学者的一个重要里程碑。扫弦的节奏感很大程度上依赖于&lt;strong&gt;稳定的右手动作&lt;/strong&gt;和&lt;strong&gt;对节拍的理解&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;这里为您提供一套系统的学习步骤和技巧：&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="-初学者掌握扫弦节奏的五大步骤"&gt;🎸 初学者掌握扫弦节奏的五大步骤&lt;/h2&gt;
&lt;h3 id="1-专注右手动作-无和弦练习"&gt;1. 专注右手动作 (无和弦练习)&lt;/h3&gt;
&lt;p&gt;在开始担心和弦之前，先让您的右手独立稳定下来。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;⚡️ 静音练习（Muting）:&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;用您的&lt;strong&gt;左手&lt;/strong&gt;轻轻地搭在琴弦上，但不要按实，让所有琴弦发出“闷”或“沙”的声音（这被称为&lt;strong&gt;闷音&lt;/strong&gt;或&lt;strong&gt;制音&lt;/strong&gt;）。&lt;/li&gt;
&lt;li&gt;只用您的&lt;strong&gt;右手&lt;/strong&gt;（拨片或手指）进行上下扫弦练习。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;目标：&lt;/strong&gt; 确保您的上下扫弦声音均匀、力度一致，并且动作非常放松。手腕应该是驱动力，而不是手臂。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;⏱️ 使用节拍器 (Metronome):&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;将节拍器设置为一个非常慢的速度（例如：每分钟 &lt;strong&gt;60-80 拍&lt;/strong&gt;）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;练习一：&lt;/strong&gt; 每一拍只扫一次（下扫 $\downarrow$）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;练习二：&lt;/strong&gt; 每一拍扫两次（下扫 $\downarrow$ 和上扫 $\uparrow$）。记住，$\downarrow$ 在拍子上，$\uparrow$ 在“and”上（即两拍之间）。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="2-理解基本节奏型"&gt;2. 理解基本节奏型&lt;/h3&gt;
&lt;p&gt;初学者最常用的节奏型是&lt;strong&gt;四分音符&lt;/strong&gt;和&lt;strong&gt;八分音符&lt;/strong&gt;。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;四分音符（每拍一扫）：&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;数数方式：&lt;strong&gt;1&lt;/strong&gt; - 2 - 3 - 4&lt;/li&gt;
&lt;li&gt;扫弦方向：$\downarrow$ - (停) - $\downarrow$ - (停) - $\downarrow$ - (停) - $\downarrow$ - (停)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;八分音符（每拍两扫）：&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;数数方式：&lt;strong&gt;1&lt;/strong&gt; &amp;amp; &lt;strong&gt;2&lt;/strong&gt; &amp;amp; &lt;strong&gt;3&lt;/strong&gt; &amp;amp; &lt;strong&gt;4&lt;/strong&gt; &amp;amp;&lt;/li&gt;
&lt;li&gt;扫弦方向：$\downarrow$ $\uparrow$ $\downarrow$ $\uparrow$ $\downarrow$ $\uparrow$ $\downarrow$ $\uparrow$&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;✍️ 建议：&lt;/strong&gt; 在练习时，&lt;strong&gt;务必&lt;/strong&gt;将数数（1 &amp;amp; 2 &amp;amp;&amp;hellip;）和您的扫弦声音同步说出来。这能帮助您将听觉、视觉和动作联系起来。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="3-掌握基础节奏型以八分音符为主"&gt;3. 掌握基础节奏型（以八分音符为主）&lt;/h3&gt;
&lt;p&gt;一旦您能稳定地进行“$\downarrow$ $\uparrow$ $\downarrow$ $\uparrow$”的连贯扫弦，就可以开始学习初学最常用的、带&lt;strong&gt;休止&lt;/strong&gt;或&lt;strong&gt;省略&lt;/strong&gt;的节奏型了。&lt;/p&gt;</description></item></channel></rss>